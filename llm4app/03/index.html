
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mydomain.org/mysite/03/">
      
      
        <link rel="prev" href="../02/">
      
      
        <link rel="next" href="../04/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>第3章 移动应用开发基础 - 大模型重塑移动应用开发</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#3" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="大模型重塑移动应用开发" class="md-header__button md-logo" aria-label="大模型重塑移动应用开发" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            大模型重塑移动应用开发
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              第3章 移动应用开发基础
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="大模型重塑移动应用开发" class="md-nav__button md-logo" aria-label="大模型重塑移动应用开发" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    大模型重塑移动应用开发
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    前言
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第1章：大模型基本介绍
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第2章 移动应用开发基础
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    第3章 移动应用开发基础
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    第3章 移动应用开发基础
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 安卓开发环境搭建
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.1 安卓开发环境搭建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#311-android-studio" class="md-nav__link">
    <span class="md-ellipsis">
      3.1.1 Android Studio的下载安装
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#312" class="md-nav__link">
    <span class="md-ellipsis">
      3.1.2 快速上手
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32-activity" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Activity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2 Activity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-activity" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.1 Activity的生命周期
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-activity" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.2 Activity的跳转
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2.2 Activity的跳转">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      基本跳转
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      带参数跳转
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      跳转关系的可视化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      跳转的高级用法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#323-activity" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.3 大模型生成Activity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      目标
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      实现过程
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#33-intent" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Intent
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.3 Intent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#331-intent" class="md-nav__link">
    <span class="md-ellipsis">
      3.3.1 Intent的使用场景
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#332-intent" class="md-nav__link">
    <span class="md-ellipsis">
      3.3.2 大模型生成Intent代码的示例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#34-layout" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 Layout
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.4 Layout">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#341" class="md-nav__link">
    <span class="md-ellipsis">
      3.4.1 布局方式简介
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#342-constrain-layout" class="md-nav__link">
    <span class="md-ellipsis">
      3.4.2 Constrain Layout（约束布局）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#343" class="md-nav__link">
    <span class="md-ellipsis">
      3.4.3 编辑器设计布局示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#344" class="md-nav__link">
    <span class="md-ellipsis">
      3.4.4 大模型设计布局示例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#35-listener" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 Listener
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.5 Listener">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#351" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.1 监听器的概念
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#352" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.2 监听器的作用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#353" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.3 监听器的工作原理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#354" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.4 常见的监听器类型
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#355" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.5. 监听器的注册方式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.5.5. 监听器的注册方式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      （1）匿名内部类
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      （2）内部类
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      （3）外部类
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4activityfragment" class="md-nav__link">
    <span class="md-ellipsis">
      （4）Activity或Fragment自身实现接口
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5xml" class="md-nav__link">
    <span class="md-ellipsis">
      （5）通过XML设置
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#356" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.6 监听器的回调方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#358-listener" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.8 大模型使用Listener案例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#359" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.9 总结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#36-fragment" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 Fragment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.6 Fragment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#361-fragment" class="md-nav__link">
    <span class="md-ellipsis">
      3.6.1 Fragment介绍
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#361-fragment_1" class="md-nav__link">
    <span class="md-ellipsis">
      3.6.1 Fragment的特性
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.6.1 Fragment的特性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      （1）模块化与复用性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      （2）动态性与灵活性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    <span class="md-ellipsis">
      （3）多屏适配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4activity" class="md-nav__link">
    <span class="md-ellipsis">
      （4）与Activity的协作
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      （5）状态保存与恢复
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6fragment" class="md-nav__link">
    <span class="md-ellipsis">
      （6）嵌套Fragment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#363-fragment" class="md-nav__link">
    <span class="md-ellipsis">
      3.6.3 Fragment的使用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#37-tabnavigation" class="md-nav__link">
    <span class="md-ellipsis">
      3.7 Tab和Navigation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.7 Tab和Navigation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#371-tab" class="md-nav__link">
    <span class="md-ellipsis">
      3.7.1 Tab的介绍与使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#372-navigation" class="md-nav__link">
    <span class="md-ellipsis">
      3.7.2 Navigation的介绍和使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#373-tab" class="md-nav__link">
    <span class="md-ellipsis">
      3.7.3 大模型实现Tab的示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#374" class="md-nav__link">
    <span class="md-ellipsis">
      3.7.4 大模型实现底部导航栏的示例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#38-recyclerview" class="md-nav__link">
    <span class="md-ellipsis">
      3.8 RecyclerView
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.8 RecyclerView">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#381-recyclerview" class="md-nav__link">
    <span class="md-ellipsis">
      3.8.1 RecyclerView的组件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#382-recycleview" class="md-nav__link">
    <span class="md-ellipsis">
      3.8.2 RecycleView的使用方式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#383-recyclerview" class="md-nav__link">
    <span class="md-ellipsis">
      3.8.3 大模型在RecyclerView中的应用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#39" class="md-nav__link">
    <span class="md-ellipsis">
      3.9 网络相关功能
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.9 网络相关功能">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#391-socket" class="md-nav__link">
    <span class="md-ellipsis">
      3.9.1 Socket编程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#392-httphttps" class="md-nav__link">
    <span class="md-ellipsis">
      3.9.2 HTTP/HTTPS基础
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#393-https" class="md-nav__link">
    <span class="md-ellipsis">
      3.9.3 大模型在获取HTTPS内容中的应用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#310" class="md-nav__link">
    <span class="md-ellipsis">
      3.10 保存和恢复数据
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第4章 大模型应用开发技巧
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第5章 开发案例：纸牌配对游戏
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第6章 开发案例：井字棋
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第7章 未来前景和总结
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 安卓开发环境搭建
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.1 安卓开发环境搭建">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#311-android-studio" class="md-nav__link">
    <span class="md-ellipsis">
      3.1.1 Android Studio的下载安装
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#312" class="md-nav__link">
    <span class="md-ellipsis">
      3.1.2 快速上手
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32-activity" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Activity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2 Activity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#321-activity" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.1 Activity的生命周期
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#322-activity" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.2 Activity的跳转
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2.2 Activity的跳转">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      基本跳转
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      带参数跳转
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      跳转关系的可视化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      跳转的高级用法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#323-activity" class="md-nav__link">
    <span class="md-ellipsis">
      3.2.3 大模型生成Activity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      目标
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      实现过程
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#33-intent" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Intent
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.3 Intent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#331-intent" class="md-nav__link">
    <span class="md-ellipsis">
      3.3.1 Intent的使用场景
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#332-intent" class="md-nav__link">
    <span class="md-ellipsis">
      3.3.2 大模型生成Intent代码的示例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#34-layout" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 Layout
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.4 Layout">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#341" class="md-nav__link">
    <span class="md-ellipsis">
      3.4.1 布局方式简介
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#342-constrain-layout" class="md-nav__link">
    <span class="md-ellipsis">
      3.4.2 Constrain Layout（约束布局）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#343" class="md-nav__link">
    <span class="md-ellipsis">
      3.4.3 编辑器设计布局示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#344" class="md-nav__link">
    <span class="md-ellipsis">
      3.4.4 大模型设计布局示例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#35-listener" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 Listener
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.5 Listener">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#351" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.1 监听器的概念
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#352" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.2 监听器的作用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#353" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.3 监听器的工作原理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#354" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.4 常见的监听器类型
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#355" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.5. 监听器的注册方式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.5.5. 监听器的注册方式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      （1）匿名内部类
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      （2）内部类
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      （3）外部类
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4activityfragment" class="md-nav__link">
    <span class="md-ellipsis">
      （4）Activity或Fragment自身实现接口
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5xml" class="md-nav__link">
    <span class="md-ellipsis">
      （5）通过XML设置
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#356" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.6 监听器的回调方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#358-listener" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.8 大模型使用Listener案例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#359" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.9 总结
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#36-fragment" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 Fragment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.6 Fragment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#361-fragment" class="md-nav__link">
    <span class="md-ellipsis">
      3.6.1 Fragment介绍
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#361-fragment_1" class="md-nav__link">
    <span class="md-ellipsis">
      3.6.1 Fragment的特性
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.6.1 Fragment的特性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      （1）模块化与复用性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      （2）动态性与灵活性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_2" class="md-nav__link">
    <span class="md-ellipsis">
      （3）多屏适配
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4activity" class="md-nav__link">
    <span class="md-ellipsis">
      （4）与Activity的协作
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      （5）状态保存与恢复
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6fragment" class="md-nav__link">
    <span class="md-ellipsis">
      （6）嵌套Fragment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#363-fragment" class="md-nav__link">
    <span class="md-ellipsis">
      3.6.3 Fragment的使用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#37-tabnavigation" class="md-nav__link">
    <span class="md-ellipsis">
      3.7 Tab和Navigation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.7 Tab和Navigation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#371-tab" class="md-nav__link">
    <span class="md-ellipsis">
      3.7.1 Tab的介绍与使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#372-navigation" class="md-nav__link">
    <span class="md-ellipsis">
      3.7.2 Navigation的介绍和使用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#373-tab" class="md-nav__link">
    <span class="md-ellipsis">
      3.7.3 大模型实现Tab的示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#374" class="md-nav__link">
    <span class="md-ellipsis">
      3.7.4 大模型实现底部导航栏的示例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#38-recyclerview" class="md-nav__link">
    <span class="md-ellipsis">
      3.8 RecyclerView
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.8 RecyclerView">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#381-recyclerview" class="md-nav__link">
    <span class="md-ellipsis">
      3.8.1 RecyclerView的组件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#382-recycleview" class="md-nav__link">
    <span class="md-ellipsis">
      3.8.2 RecycleView的使用方式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#383-recyclerview" class="md-nav__link">
    <span class="md-ellipsis">
      3.8.3 大模型在RecyclerView中的应用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#39" class="md-nav__link">
    <span class="md-ellipsis">
      3.9 网络相关功能
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.9 网络相关功能">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#391-socket" class="md-nav__link">
    <span class="md-ellipsis">
      3.9.1 Socket编程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#392-httphttps" class="md-nav__link">
    <span class="md-ellipsis">
      3.9.2 HTTP/HTTPS基础
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#393-https" class="md-nav__link">
    <span class="md-ellipsis">
      3.9.3 大模型在获取HTTPS内容中的应用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#310" class="md-nav__link">
    <span class="md-ellipsis">
      3.10 保存和恢复数据
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="3">第3章 移动应用开发基础</h1>
<p>本章旨在为初学者提供一个系统、全面的学习路径，从基础到进阶，逐步深入Android应用开发的核心技术。读者将从零开始，逐步掌握Android应用开发的核心技术和最佳实践。
<strong>每一节都是一个独立的学习单元，但它们之间又紧密相连，共同构成了一个完整的Android应用开发知识体系。</strong>
希望本教程能够帮助读者在移动应用开发上打下基础。</p>
<p>本章包括以下几个部分：</p>
<p><strong>3.1 安卓开发环境搭建</strong></p>
<p><strong>基础</strong>：搭建开发环境是学习Android开发的第一步，为后续章节提供开发工具和平台支持。</p>
<p><strong>3.2 Activity</strong></p>
<p><strong>核心组件</strong>：Activity是Android应用的核心组件，负责显示用户界面。理解Activity的生命周期和管理是开发Android应用的基础。</p>
<p><strong>3.3 Intent</strong></p>
<p><strong>组件通信</strong>：Intent是Activity、Service和BroadcastReceiver之间通信的桥梁，通过Intent可以实现组件之间的跳转和数据传递。</p>
<p><strong>3.4 Layout</strong></p>
<p><strong>用户界面设计</strong>：布局是用户界面的基础，通过学习不同的布局类型，可以设计出美观且功能强大的用户界面。</p>
<p><strong>3.5 Listener</strong></p>
<p><strong>事件处理</strong>：Listener用于处理用户交互事件，如点击、触摸等。通过Listener可以实现动态的用户交互，增强应用的交互性。</p>
<p><strong>3.6 Fragment</strong></p>
<p><strong>模块化开发</strong>：Fragment是Activity的扩展，用于构建模块化的用户界面。通过Fragment可以实现更加灵活和动态的界面布局。</p>
<p><strong>3.7 Tab和Navigation</strong></p>
<p><strong>导航设计</strong>：Tab和Navigation是现代Android应用中常见的导航方式。通过学习Tab和Navigation，可以优化应用的结构和用户体验。</p>
<p><strong>3.8 RecyclerView</strong></p>
<p><strong>数据展示</strong>：RecyclerView是高效展示大量数据的组件，通过学习RecyclerView可以实现高性能的数据展示和动态更新。</p>
<p><strong>3.9 网络相关功能</strong></p>
<p><strong>网络交互</strong>：网络功能是现代应用的重要组成部分。通过学习Socket编程和okHttp，可以实现应用与外部世界的网络通信。</p>
<p><strong>3.10 保存和恢复数据</strong></p>
<p><strong>数据保存与恢复</strong>：保存和恢复数据是应用开发中的关键环节。通过学习数据持久化技术，如文件存储、SharedPreferences和数据库操作，可以实现用户数据的稳定保存和高效恢复，确保应用在不同场景下能够持续提供一致的用户体验。</p>
<p>除非特别声明，本书中的移动应用开发主要是在Android（安卓）操作系统上的移动应用，开发过程主要基于Android Studio软件，使用Java语言进行，这也算是一种最原始的移动应用开发的方式。以此为基础，可以讲清楚很多移动应用开发中的基本概念，其他的平台可以以此类推。</p>
<h2 id="31">3.1 安卓开发环境搭建</h2>
<p>在开始Android应用开发之前，搭建一个稳定且高效的开发环境至关重要。本章将详细介绍如何安装和配置Android Studio、设置Java开发环境，以及如何使用模拟器和真机进行调试。这是整个学习过程的基础，为后续章节的学习打下坚实的基础。</p>
<h3 id="311-android-studio">3.1.1 Android Studio的下载安装</h3>
<p>Android Studio官方下载地址为https://developer.android.com/studio?hl=zh-cn，读者们可以自行下载安装。值得注意的是在用Android Studio创建项目后可能遇到gradle sync failed错误。解决这个问题的方法包括Gradle换源、配置代理等方式，读者可以自行搜索相关的教程。</p>
<h3 id="312">3.1.2 快速上手</h3>
<p>打开Android Studio软件，首先新建一个空项目，选择Empty Activity（Kotlin）或Empty Views Activity（Java），就可以创建一个空白的应用了，如下图所示。如果你有相关的编程软件使用经验，例如visual studio等，这一步应该就非常熟悉了。本书也是假设读者有相关的编程基础。因此如何使用Java语言，如何使用基本的软件，在本书中就不过多介绍，感兴趣的读者可以去阅读相关材料。</p>
<p><img alt="图3-1 Android Studio创建新项目" src="../fig03/3-1.png" /></p>
<!-- 图3-1 Android Studio创建新项目 -->

<!-- 建议加个居中 -->
<!-- 
<p style="text-align: center">图3-1 Android Studio创建新项目</p>
-->
<!-- 先不改了 -->

<h2 id="32-activity">3.2 Activity</h2>
<p><strong>Activity是Android应用的核心组件之一，它代表了用户界面的一个屏幕。理解Activity是掌握Android应用架构的关键。</strong>
本章将深入讲解Activity的生命周期、创建和管理Activity的方法，以及如何通过Activity实现用户交互。在基于Android的移动应用开发中，Activity是一个核心组件，这个单词还不好直接翻译，通过英文单词理解它的意思还更加直接，从形式上看，它表示应用程序的一个单独屏幕内容。例如下图所示，笔记、计算器和地图等都是一个Activity的表现形式。每个Activity通常包含一个用户界面，用户可以在其中与应用程序进行交互，这也是为什么被称为Activity的原因。Activity之间可以跳转，就跟我们平时使用应用一样，例如，一个邮件应用程序可能有一个显示收件箱的Activity和另一个撰写新邮件的Activity，两个Activity之间还可以通过点击某些按钮跳转。</p>
<p><img alt="图3-2 Activity的表现形式" src="../fig03/3-2.png" /></p>
<!-- 图3-2 Activity的表现形式 -->

<p>Activity的主要职责包括：（1）显示用户界面，每个Activity都负责绘制用户界面，它通常由XML布局文件定义；（2）响应用户操作，Activity处理用户的输入并与其他组件（如Service、BroadcastReceiver）进行交互；（3）管理应用程序的生命周期：Activity管理其生命周期状态，从创建到销毁，这一点对于资源管理尤为重要。
从粗粒度的角度来说，一个应用就是一系列Activity的组合，APP=Activity+Activity+...，因此理解了Activity对于理解移动应用开发非常重要。</p>
<h3 id="321-activity">3.2.1 Activity的生命周期</h3>
<p>Activity的生命周期由一系列方法管理，这些方法在Activity的状态发生变化时调用。理解Activity的生命周期对于编写高效、稳定的应用程序至关重要。下面是Activity生命周期的主要阶段：</p>
<p>（1）创建（onCreate）,onCreate()方法是Activity的入口点。当Activity第一次创建时调用，通常在这里进行初始化工作，如设置用户界面（通过setContentView方法）和绑定数据。</p>
<p>（2）启动（onStart）,onStart()方法在Activity变得对用户可见时调用。此时Activity已经创建，但还没有进入前台。</p>
<p>（3）恢复（onResume）,onResume()方法在Activity开始与用户交互之前调用。此时，Activity位于栈顶，并且是前台Activity。</p>
<p>（4）暂停（onPause）,onPause()方法在系统即将启动另一个Activity之前调用。这个方法用于保存数据和释放资源，因为Activity可能很快会被销毁。</p>
<p>（5）停止（onStop）,onStop()方法在Activity不再对用户可见时调用。此时，Activity可能会被销毁或重新启动。</p>
<p>（6）销毁（onDestroy）,onDestroy()方法在Activity被销毁之前调用。这个方法用于执行清理工作，比如释放资源。</p>
<p>（7）重新启动（onRestart）,onRestart()方法在Activity从停止状态重新启动时调用。此方法用于重新初始化在onStop()中释放的资源。</p>
<p><img alt="图3-3 Activity的什么周期" src="../fig03/3-3.png" /></p>
<!-- 图3-3 Activity的什么周期 -->

<p>上图表达了Activity生命周期之间的关系。当用户启动一个Activity时，方法的调用顺序如下：onCreate() -&gt; onStart() -&gt; onResume()。当用户离开一个Activity时，方法的调用顺序如下：onPause() -&gt; onStop() -&gt; onDestroy()。了解这些生命周期方法以及它们的调用顺序，有助于开发者在适当的时间点执行适当的操作，从而提高应用的性能和用户体验。</p>
<h3 id="322-activity">3.2.2 Activity的跳转</h3>
<p>在Android开发中，Activity之间的跳转是实现不同界面之间交互的关键机制。Activity之间通过Intent进行跳转，Intent不仅可以指定目标Activity，还可以携带额外的数据，从而实现Activity之间的信息传递。</p>
<h4 id="_1">基本跳转</h4>
<p>当需要从一个Activity跳转到另一个Activity时，可以使用以下代码：</p>
<pre><code class="language-java">Intent intent = new Intent(this, TargetActivity.class);
startActivity(intent);
</code></pre>
<p>在这里，<code>this</code>表示当前的<code>Activity</code>，<code>TargetActivity.class</code>表示目标Activity的类名。<code>Intent</code>对象用于描述跳转的意图，<code>startActivity(intent)</code>方法则触发跳转动作。</p>
<h4 id="_2">带参数跳转</h4>
<p>Activity之间不仅可以进行跳转，还可以通过<code>Intent</code>传递数据。例如，如果需要将一些数据从当前Activity传递到目标Activity，可以使用<code>putExtra</code>方法：</p>
<pre><code class="language-java">Intent intent = new Intent(this, TargetActivity.class);
intent.putExtra(&quot;key&quot;, value); // 将数据以键值对的形式添加到Intent中
startActivity(intent);
</code></pre>
<p>在目标Activity中，可以通过<code>getIntent()</code>方法获取<code>Intent</code>对象，并通过<code>getStringExtra</code>、<code>getIntExtra</code>等方法获取传递的数据：</p>
<pre><code class="language-java">Intent intent = getIntent();
String value = intent.getStringExtra(&quot;key&quot;); // 根据键名获取传递的值
</code></pre>
<h4 id="_3">跳转关系的可视化</h4>
<p>上图展示了多个Activity之间的跳转关系。在图中，每个节点代表一个Activity，箭头表示跳转的方向。通过这种方式，可以清晰地看到不同Activity之间的交互流程。例如，从MainActivity跳转到DetailActivity，再从DetailActivity跳转到SettingActivity，这种跳转关系可以通过Intent来实现，并且可以在跳转过程中传递必要的数据。</p>
<h4 id="_4">跳转的高级用法</h4>
<p>除了基本的跳转和带参数跳转，Intent还支持更多高级功能。例如，可以使用<code>startActivityForResult</code>方法启动一个Activity，并等待其返回结果。这在需要从目标Activity获取数据时非常有用，例如在拍照或选择图片后返回结果。</p>
<pre><code class="language-java">Intent intent = new Intent(this, TargetActivity.class);
startActivityForResult(intent, REQUEST_CODE); // REQUEST_CODE用于标识请求
</code></pre>
<p>在目标Activity中，可以通过调用<code>setResult</code>方法返回数据：</p>
<pre><code class="language-java">Intent returnIntent = new Intent();
returnIntent.putExtra(&quot;result&quot;, resultValue);
setResult(Activity.RESULT_OK, returnIntent);
finish();
</code></pre>
<p>在原Activity中，可以通过<code>onActivityResult</code>方法接收返回的数据：</p>
<pre><code class="language-java">@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (requestCode == REQUEST_CODE &amp;&amp; resultCode == Activity.RESULT_OK) {
        String resultValue = data.getStringExtra(&quot;result&quot;);
        // 处理返回的数据
    }
}
</code></pre>
<p>通过这些方式，Activity之间的跳转和数据传递变得更加灵活和强大，为Android应用的开发提供了丰富的交互方式。</p>
<p><img alt="图3-4" src="../fig03/3-4.png" /></p>
<!-- 图3-4 Activity之间的跳转关系 -->

<p>可以看出来，你平时在使用App的时候看到界面一个个的跳来跳去，大概率就是使用了Intent进行了Activity跳转。因此，设计出来一个一个的Activity之后，我们就能够组合成一个我们想要的应用了，核心问题就是怎么将应用分解为一个个的Activity，以及如何实现每一个Activity。</p>
<h3 id="323-activity">3.2.3 大模型生成Activity</h3>
<h3 id="_5">目标</h3>
<p>假设作为一个初学者，我们理解了基本概念后，要写一个简单的应用，实现以下功能：</p>
<ul>
<li>生成两个Activity，分别对应动态页面和详情页面</li>
<li>在动态页面中显示任意两条动态，内容为纯文字</li>
<li>在用户点击一条动态时，会启动动态详情页面的Activity，在动态详情页面中显示该动态的文字</li>
<li>保存及恢复数据</li>
</ul>
<h3 id="_6">实现过程</h3>
<p>我们先在Android中创建一个空项目，选择Empty Views Activity，项目名称任意，其他保持默认。我们再创建添加一个新的Activity，名为DetailActivity，然后我们根据需求询问大模型。</p>
<p>对于复杂的APP，我们需要将过程进行解构：
-   实现两个Activity之间的跳转
-   实现两个Activity之间的信息传递
-   实现第二个Activity到第一个Activity的返回
-   实现数据的保存和恢复</p>
<p><strong>交互过程1：Activity之间的跳转</strong></p>
<p><strong>用户：</strong></p>
<p>请在第一个MainActivity中添加显示两个纯文本动态，并且点击动态的时候跳转到DetailActivity</p>
<p><strong>大模型：</strong></p>
<p>在第一个MainActivity中添加显示两个纯文本动态，并在点击动态时跳转到DetailActivity，可以按照以下步骤进行：</p>
<ol>
<li>在activity_main.xml布局文件中添加两个TextView控件，用于显示动态内容。例如：</li>
</ol>
<pre><code class="language-XML">&lt;LinearLayout  
android:layout_width=&quot;match_parent&quot;  
android:layout_height=&quot;match_parent&quot;  
android:orientation=&quot;vertical&quot;&gt;  

&lt;TextView  
android:id=&quot;@+id/textView_dynamic1&quot;  
android:layout_width=&quot;wrap_content&quot;  
android:layout_height=&quot;wrap_content&quot; /&gt;  

&lt;TextView  
android:id=&quot;@+id/textView_dynamic2&quot;  
android:layout_width=&quot;wrap_content&quot;  
android:layout_height=&quot;wrap_content&quot; /&gt;  
&lt;/LinearLayout&gt;  
</code></pre>
<ol>
<li>在MainActivity的Java代码中，为两个TextView控件分别设置动态内容。例如：</li>
</ol>
<pre><code class="language-Java">public class MainActivity extends AppCompatActivity {  
    @Override  
    protected void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.activity_main);  

        // 设置第一个动态内容  
        TextView textViewDynamic1 = findViewById(R.id.textView_dynamic1);  
        textViewDynamic1.setText(&quot;这是第一条动态内容&quot;);  

        // 设置第二个动态内容  
        TextView textViewDynamic2 = findViewById(R.id.textView_dynamic2);  
        textViewDynamic2.setText(&quot;这是第二条动态内容&quot;);  
    }  
}  
</code></pre>
<ol>
<li>在MainActivity中添加一个方法，用于跳转到DetailActivity。例如：</li>
</ol>
<pre><code class="language-Java">public void startDetailActivity(View view) {  
   Intentintent = new Intent(this, DetailActivity.class);  
    startActivity(intent);  
}  
</code></pre>
<ol>
<li>在MainActivity的布局文件中，为每个TextView控件添加一个点击事件监听器，并在其中调用startDetailActivity()方法。例如：</li>
</ol>
<pre><code class="language-XML">&lt;LinearLayout  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;match_parent&quot;  
    android:orientation=&quot;vertical&quot;&gt;  

    &lt;TextView  
        android:id=&quot;@+id/textView_dynamic1&quot;  
        android:layout_width=&quot;wrap_content&quot;  
        android:layout_height=&quot;wrap_content&quot;  
        android:clickable=&quot;true&quot;  
        android:onClick=&quot;startDetailActivity&quot;/&gt;  

    &lt;TextView  
        android:id=&quot;@+id/textView_dynamic2&quot;  
        android:layout_width=&quot;wrap_content&quot;  
        android:layout_height=&quot;wrap_content&quot;  
        android:clickable=&quot;true&quot;  
        android:onClick=&quot;startDetailActivity&quot;/&gt;  
&lt;/LinearLayout&gt;  
</code></pre>
<hr />
<p><strong>操作：</strong></p>
<p>根据大模型的回答，我们知道了如何在MainActivity中添加两条动态并在点击时跳转到DetailActivity，我们将生成的XML代码复制到activity_detail.xml文件中，并把Java代码复制到MainActivity.java中。</p>
<p>我们首先保留原来XML文件中的第一行，这个是XML文件的类型声明。我们将生成的代码覆盖下面代码，注意这里无法直接使用生成的代码，需要根据IDE的报错进行修复，对于这段代码，我们需要添加xmlns:android值。</p>
<pre><code>我们再看Java代码，我们同样保留源代码的前面几行，这几行的作用是声明类所在包以及导入相关的包。我们将生成的代码覆盖下面，这是Android Studio会提示需要导入一些相关的包，这是我们可以按照IDE的提示导入所需的包，现在的Android Studio也很智能了，它能够帮忙识别出来很多修改的地方，并提出正确的修改建议了，很多时候，我们使用Android Studio提出的建议就能解决很多问题。最终修复的代码如下所示：
```Java
package com.example.xxx;  

import androidx.appcompat.app.AppCompatActivity;  
import android.content.Intent;  
import android.os.Bundle;  
import android.view.View;  
import android.widget.TextView;  

public class MainActivity extends AppCompatActivity {  
    @Override  
    protected void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.activity_main);  

        // 设置第一个动态内容  
        TextView textViewDynamic1 = findViewById(R.id.textView_dynamic1);  
        textViewDynamic1.setText(&quot;这是第一条动态内容&quot;);  

        // 设置第二个动态内容  
        TextView textViewDynamic2 = findViewById(R.id.textView_dynamic2);  
        textViewDynamic2.setText(&quot;这是第二条动态内容&quot;);  
    }  

    public void startDetailActivity(View view) {  
       intent = new Intent(this, DetailActivity.class);  
        startActivity(intent);  
    }  
}  
</code></pre>
<p>现在，我们可以尝试编译运行这个APP。可以看到，现在已经实现了点击一条动态跳转到第二个Activity的功能。</p>
<p>我们现在需要实现第二个Activity显示动态内容的功能，我们继续询问大模型。</p>
<p><strong>交互过程2：跳转显示</strong></p>
<p><strong>用户：</strong></p>
<p>很好，现在进一步添加以下功能：跳转到DetailActivity的时候显示点击到的MainActivity中的动态文字。</p>
<hr />
<p><strong>大模型：</strong></p>
<p>要在跳转到DetailActivity时显示点击到的MainActivity中的动态文字，你需要做的是在跳转的时候传递这个信息。这通常通过Intent实现。以下是如何实现这一功能的步骤：</p>
<p>1.在MainActivity中处理点击事件</p>
<p>首先，你需要在MainActivity的布局文件中为每个可点击的元素（例如TextView）设置一个android:onClick属性，并为其指定一个方法（例如onTextViewClick）。</p>
<pre><code class="language-XML">&lt;TextView  
    android:id=&quot;@+id/textView_dynamic1&quot;  
    android:layout_width=&quot;wrap_content&quot;  
    android:layout_height=&quot;wrap_content&quot;  
    android:text=&quot;动态内容1&quot;  
    android:clickable=&quot;true&quot;  
    android:onClick=&quot;onTextViewClick&quot;/&gt;  
</code></pre>
<p>然后，在MainActivity的Java代码中实现这个方法，并创建一个新的Intent来启动DetailActivity，同时将动态文字作为Extra数据传递给这个Intent。</p>
<pre><code class="language-java">public void onTextViewClick(View view) {  
    // 获取要传递的动态文字  
    String dynamicText = ((TextView) view).getText().toString();  

    // 创建Intent并添加Extra数据  
   intent = new Intent(this, DetailActivity.class);  
    intent.putExtra(&quot;dynamic_text&quot;, dynamicText);  

    // 启动DetailActivity  
    startActivity(intent);  
}  
</code></pre>
<p>2.在DetailActivity中接收并显示动态文字</p>
<p>在DetailActivity的onCreate方法中，你可以获取传递过来的动态文字，并显示在相应的UI元素上。</p>
<pre><code class="language-Java">public class DetailActivity extends AppCompatActivity {  
    @Override  
    protected void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.activity_detail);  

        // 获取传递过来的动态文字  
        String dynamicText = getIntent().getStringExtra(&quot;dynamic_text&quot;);  
        if (dynamicText != null) { // 确保动态文字有效  
            // 显示动态文字（这里只是一个示例，实际显示方式可能会有所不同）  
            TextView textViewContent = findViewById(R.id.textView_content);  
            textViewContent.setText(dynamicText);  
        } else { // 如果没有传递动态文字，则显示默认内容或提示错误信息（这里只是一个示例）  
            TextView textViewContent = findViewById(R.id.textView_content);  
            textViewContent.setText(&quot;无法找到动态内容&quot;); // 这里只是一个示例，实际内容可能会有所不同  
        }  
    }  
}  
</code></pre>
<p>通过以上步骤，你可以在跳转到DetailActivity时显示点击到的MainActivity中的动态文字。记得根据你的具体需求调整代码。</p>
<hr />
<p><strong>操作：</strong></p>
<p>大模型告诉我们需要通过Intent传递数据，但是它创建了新的方法，这是没有必要的，我们直接将相应代码复制到startDetailActivity方法内，修改得到的Java代码如下所示：</p>
<pre><code class="language-Java">package com.example.demo3;  

import androidx.appcompat.app.AppCompatActivity;  

import android.content.Intent;  
import android.os.Bundle;  
import android.view.View;  
import android.widget.TextView;  

public class MainActivity extends AppCompatActivity {  
    @Override  
    protected void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.activity_main);  

        // 设置第一个动态内容  
        TextView textViewDynamic1 = findViewById(R.id.textView_dynamic1);  
        textViewDynamic1.setText(&quot;这是第一条动态内容&quot;);  

        // 设置第二个动态内容  
        TextView textViewDynamic2 = findViewById(R.id.textView_dynamic2);  
        textViewDynamic2.setText(&quot;这是第二条动态内容&quot;);  
    }  

    public void startDetailActivity(View view) {  
        // 获取要传递的动态文字  
        String dynamicText = ((TextView) view).getText().toString();  

        // 创建Intent并添加Extra数据  
        intent = new Intent(this, DetailActivity.class);  
        intent.putExtra(&quot;dynamic_text&quot;, dynamicText);  

        // 启动DetailActivity  
        startActivity(intent);  
    }  
}  
</code></pre>
<p>然后修改<code>DetailActivity</code>的代码，如下所示：</p>
<pre><code class="language-Java">package com.example.demo3;  

import androidx.appcompat.app.AppCompatActivity;  

import android.os.Bundle;  
import android.widget.TextView;  

public class DetailActivity extends AppCompatActivity {  
    @Override  
    protected void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.activity_detail);  

        // 获取传递过来的动态文字    
        String dynamicText = getIntent().getStringExtra(&quot;dynamic_text&quot;);  
        if (dynamicText != null) { // 确保动态文字有效    
            // 显示动态文字（这里只是一个示例，实际显示方式可能会有所不同）    
            TextView textViewContent = findViewById(R.id.textView_content);  
            textViewContent.setText(dynamicText);  
        } else { // 如果没有传递动态文字，则显示默认内容或提示错误信息（这里只是一个示例）    
            TextView textViewContent = findViewById(R.id.textView_content);  
            textViewContent.setText(&quot;无法找到动态内容&quot;); // 这里只是一个示例，实际内容可能会有所不同    
        }  
    }  
} 
</code></pre>
<p>我们发现这个程序会报错，大模型没有提供布局文件activity_detail.xml，我们继续询问大模型。</p>
<hr />
<p><strong>交互过程3：补充缺失文件</strong></p>
<p><strong>用户：</strong></p>
<p>此时DetailActivity的布局文件应该是怎么样的？</p>
<hr />
<p><strong>大模型：</strong></p>
<p>要实现这个功能，你需要创建一个DetailActivity的布局文件，这个布局文件应该包含一个TextView来显示动态文字。</p>
<p>以下是一个简单的DetailActivity布局文件示例：</p>
<pre><code class="language-XML">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;match_parent&quot;  
    android:orientation=&quot;vertical&quot;&gt;  

    &lt;TextView  
        android:id=&quot;@+id/textView_content&quot;  
        android:layout_width=&quot;wrap_content&quot;  
        android:layout_height=&quot;wrap_content&quot;  
        android:textSize=&quot;20sp&quot; /&gt;  
&lt;/LinearLayout&gt; 
</code></pre>
<p>在这个布局文件中，我们定义了一个TextView，它的id为textView_content，用于显示动态文字。你可以根据需要调整布局和样式。</p>
<hr />
<p><strong>操作：</strong></p>
<p>我们将生成的代码复制到相应文件中，这里还是得注意链接Java类，即xmlns:tools和tools:context，这是文件格式的要求，修改后的代码如下所示：</p>
<pre><code class="language-XML">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;  
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;match_parent&quot;  
    android:orientation=&quot;vertical&quot;  
    tools:context=&quot;.DetailActivity&quot;&gt;  

    &lt;TextView  
        android:id=&quot;@+id/textView_content&quot;  
        android:layout_width=&quot;wrap_content&quot;  
        android:layout_height=&quot;wrap_content&quot;  
        android:textSize=&quot;20sp&quot; /&gt;  
&lt;/LinearLayout&gt; 
</code></pre>
<p>再次编译运行程序，可以看见已经实现点击动态后在打开的第二个界面中显示动态内容。</p>
<p>现在我们想在第二个Activity中添加返回上一级功能，我们继续询问大模型。</p>
<hr />
<p><strong>交互过程4：返回功能</strong></p>
<p><strong>用户：</strong></p>
<p>如何在打开的Activity左上角显示返回按钮？</p>
<hr />
<p><strong>大模型：</strong></p>
<p>要在打开的Activity左上角显示返回按钮，你可以在布局文件中添加一个返回按钮，或者在代码中动态添加。以下是在布局文件中添加返回按钮的示例：</p>
<p>1.在你的布局文件中，添加一个Button元素作为返回按钮：</p>
<pre><code class="language-XML">&lt;Button  
    android:id=&quot;@+id/button_back&quot;  
    android:layout_width=&quot;wrap_content&quot;  
    android:layout_height=&quot;wrap_content&quot;  
    android:text=&quot;返回&quot; /&gt;  
</code></pre>
<p>2.在你的布局文件中，添加一个Button元素作为返回按钮：</p>
<pre><code class="language-Java">Button backButton = findViewById(R.id.button_back);  
backButton.setOnClickListener(new View.OnClickListener() {  
    @Override  
    public void onClick(View v) {  
        onBackPressed(); // 调用onBackPressed()方法实现返回功能  
    }  
}); 
</code></pre>
<p>这样，当用户点击返回按钮时，就会调用onBackPressed()方法，实现返回上一个Activity的功能。你可以根据需要自定义按钮的样式和文本。</p>
<hr />
<p><strong>操作：</strong></p>
<p>我们分别在布局文件中添加按钮以及在Java文件中添加代码，修改后的XML文件如下所示：</p>
<pre><code class="language-XML">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;  
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;match_parent&quot;  
    android:orientation=&quot;vertical&quot;  
    tools:context=&quot;.DetailActivity&quot;&gt;  

    &lt;Button  
        android:id=&quot;@+id/button_back&quot;  
        android:layout_width=&quot;wrap_content&quot;  
        android:layout_height=&quot;wrap_content&quot;  
        android:text=&quot;返回&quot; /&gt;  

    &lt;TextView  
        android:id=&quot;@+id/textView_content&quot;  
        android:layout_width=&quot;wrap_content&quot;  
        android:layout_height=&quot;wrap_content&quot;  
        android:textSize=&quot;20sp&quot; /&gt;  
&lt;/LinearLayout&gt;  
</code></pre>
<p>修改后的Java文件如下所示：</p>
<pre><code class="language-Java">package com.example.demo3;  

import androidx.appcompat.app.AppCompatActivity;  

import android.os.Bundle;  
import android.view.View;  
import android.widget.Button;  
import android.widget.TextView;  

public class DetailActivity extends AppCompatActivity {  
    @Override  
    protected void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.activity_detail);  

        Button backButton = findViewById(R.id.button_back);  
        backButton.setOnClickListener(new View.OnClickListener() {  
            @Override  
            public void onClick(View v) {  
                onBackPressed(); // 调用onBackPressed()方法实现返回功能  
            }  
        });  

        // 获取传递过来的动态文字  
        String dynamicText = getIntent().getStringExtra(&quot;dynamic_text&quot;);  
        if (dynamicText != null) { // 确保动态文字有效  
            // 显示动态文字（这里只是一个示例，实际显示方式可能会有所不同）  
            TextView textViewContent = findViewById(R.id.textView_content);  
            textViewContent.setText(dynamicText);  
        } else { // 如果没有传递动态文字，则显示默认内容或提示错误信息（这里只是一个示例）  
            TextView textViewContent = findViewById(R.id.textView_content);  
            textViewContent.setText(&quot;无法找到动态内容&quot;); // 这里只是一个示例，实际内容可能会有所不同  
        }  
    }  
}  
</code></pre>
<p>再次编译运行程序，可以看到第二个界面中出现了“返回”按钮，可以返回第一个界面。
在此，我们实现了两个Activity的跳转与数据传递。当然，读者还可以思考，能否实现其他的返回形式，比如可以在整个Activity的左上角添加一个返回按钮，就像很多应用里面展示的一样。</p>
<hr />
<h2 id="33-intent">3.3 Intent</h2>
<p>回过头来，我们再看看Intent。Intent是Android应用中用于组件之间通信的机制，是实现Android应用功能的关键纽带。通过Intent，Activity、Service和BroadcastReceiver之间可以相互协作。Activity、Service和BroadcastReceiver是Android系统提供的几个重要组件，换句话说就是Android系统提供的几个实现应用的基础功能。本章将介绍Intent的基本概念、显式Intent与隐式Intent的使用，以及如何通过Intent传递数据。</p>
<h3 id="331-intent">3.3.1 Intent的使用场景</h3>
<p>前面我们已经看到了Intent的使用基本方法，Intent是Android系统中一个用于传递消息的对象,事实上Intent在操作系统中的作用就跟它的名字一下，是操作系统通信的机制，告诉操作系统相关“意图”，然后操作系统执行对应的操作。它可以在应用内部或应用之间传递数据和触发动作。Intent可以用于启动活动（Activity）、服务（Service）、广播接收器（Broadcast Receiver）等组件。</p>
<p>Intent可以分为两类：（1）显式Intent（Explicit Intent），显式指定要启动的组件（如某个具体的Activity或Service）。一般用于应用内部的组件之间进行通信；（2）隐式Intent（Implicit Intent），没有指定具体的组件，而是通过指定动作、数据等信息，让系统选择符合条件的组件来处理。常用于调用系统的功能或与其他应用交互。</p>
<p>构建Intent可以包含以下内容：（1）组件名称，由名称定义的应用组件，没有即隐式，例如：com.example.ExampleActivity；（2）操作，指定要执行的通用操作的字符串，如ACTION_VIEW：可向用户显示信息（使用图库应用查看的照片；或者要使用地图应用查看的地址），ACTION_SEND：可发送或者共享数据（电子邮件应用或社交共享应用）；（3）数据，引用待操作数据和/或该数据URI，提供的数据类型通常由intent的操作决定；（4）类别，应处理Intent的组件类型；（5）Extra：完成请求操作所需的附加信息的键值对，如EXTRA_EMAIL：指定目标收件人；（6）标志：元数据，标志系统如何启动和处理Activity</p>
<p>隐式Intent与系统的交互包括以下过程：（1）使用隐式Intent时，Android 系统通过将Intent的内容与在设备上其他应用的清单文件中声明的Intent过滤器进行比较，从而找到要启动的相应组件；（2）如果Intent与Intent过滤器匹配，则系统将启动该组件，并向其传递Intent对象；（3）如果多个Intent过滤器兼容，则系统会显示一个对话框，支持用户选取要使用的应用。</p>
<p>Intent有以下的使用场景：</p>
<p>（1）启动新Activity：当用户点击按钮时，从一个Activity跳转到另一个Activity。</p>
<pre><code class="language-java">// 在MainActivity中  

IntentIntent= new Intent(MainActivity.this, DetailActivity.class);  
intent.putExtra(&quot;username&quot;, &quot;JohnDoe&quot;);  
startActivity(intent);  

// 在DetailActivity中接收数据  
String username = getIntent().getStringExtra(&quot;username&quot;); 
</code></pre>
<p>（2）启动服务（Service）：当需要在后台执行一些任务时,比如下载时，可以通过Intent启动一个Service形式执行。</p>
<pre><code class="language-java">// 在MainActivity中  
IntentIntent= new Intent(MainActivity.this, MyService.class);  
startService(intent);  

// 在MyService类中  
public class MyService extends Service {  
    @Override  
    public int onStartCommand(Intent intent, int flags, int startId) {  
        // 执行后台任务  
        return START_STICKY;  
    }  
}  
</code></pre>
<p>（3）发送广播（Broadcast）：通过Intent还可以让操作系统来发送广播，当需要通知其他组件或应用某些事件时，可以发送广播。Broadcast也是Android操作系统提供的一个组件，用于操作系统内部进行广播通信。每一个应用中都可以使用Broadcast组件接收系统发送过来的消息。</p>
<pre><code class="language-java">// 发送广播  
IntentIntent= new Intent(&quot;com.example.CUSTOM_BROADCAST&quot;);  
sendBroadcast(intent);  

// 接收广播  
public class MyBroadcastReceiver extends BroadcastReceiver {  
    @Override  
    public void onReceive(Context context,Intentintent) {  
        // 处理广播事件  
    }  
}  
</code></pre>
<p>例如，在应用中，我们常见的分享文字，当用户希望将某段文字通过社交媒体、邮件等方式分享出去时，可以使用隐式Intent。</p>
<pre><code class="language-java">// 要分享的文字内容  
String textToShare = &quot;这是我要分享的文字内容&quot;;  

// 创建一个隐式Intent  
Intent shareIntent = new Intent();  
shareIntent.setAction(Intent.ACTION_SEND);  
shareIntent.putExtra(Intent.EXTRA_TEXT, textToShare);  
shareIntent.setType(&quot;text/plain&quot;);  

// 启动分享的Activity  
startActivity(Intent.createChooser(shareIntent, &quot;选择分享方式&quot;)); 
</code></pre>
<p>分享图片的过程与分享文字类似，只需将Intent的类型设置为图片类型，并附加图片的URI。注意在这里面，我们传递消息给其他Activity的时候，也附加上了对应的文字或者图片信息，这样在新启动的Activity中就能够获取到要分享的文字或者图片。</p>
<pre><code class="language-java">// 图片的URI  
Uri imageUri = Uri.parse(&quot;android.resource://com.example.myapp/&quot; + R.drawable.image_to_share);  

// 创建一个隐式Intent  
Intent shareIntent = new Intent();  
shareIntent.setAction(Intent.ACTION_SEND);  
shareIntent.putExtra(Intent.EXTRA_STREAM, imageUri);  
shareIntent.setType(&quot;image/*&quot;);  

// 启动分享的Activity  
startActivity(Intent.createChooser(shareIntent, &quot;选择分享方式&quot;)); 
</code></pre>
<h3 id="332-intent">3.3.2 大模型生成Intent代码的示例</h3>
<p>目标：我们将要写一个简单的应用，用户输入一个URL,然后点击按钮使用浏览器打开这个链接。分析一下，如果我们理解了Intent和Android开发的理念，我们就知道这个过程其实就是在用户Activity和浏览器对应的这个Activity之间的跳转，同时跳转的过程还需要带上用户的URL。注意，浏览器的URL如何访问目前我们还不知道，读者可以先想想怎么确定这个Activity名字。</p>
<p><strong>交互过程1：目标输入</strong></p>
<p><strong>用户：</strong></p>
<p>请用Android studio和java帮我生成一个app，我可以输入一个URL，点击按钮跳转使用浏览器打开这个URL。</p>
<p><strong>大模型：</strong></p>
<p>当然，我可以帮你生成一个简单的Android应用，该应用允许用户输入一个URL，并点击按钮以在浏览器中打开该URL。以下是实现这个功能的步骤和代码示例。</p>
<p>1.设置新的Android Studio项目</p>
<p>首先，打开Android Studio并创建一个新的项目。选择“Empty Activity”作为初始活动。</p>
<p>2.设计界面</p>
<p>在activity_main.xml中，你需要添加一个EditText用于输入URL和一个Button用于触发跳转。XML布局可能看起来像这样：</p>
<pre><code class="language-XML">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;    
&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;    
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;    
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;    
    android:layout_width=&quot;match_parent&quot;    
    android:layout_height=&quot;match_parent&quot;    
    android:padding=&quot;16dp&quot;    
    tools:context=&quot;.MainActivity&quot;&gt;    

    &lt;EditText    
        android:id=&quot;@+id/urlInput&quot;    
        android:layout_width=&quot;match_parent&quot;    
        android:layout_height=&quot;wrap_content&quot;    
        android:hint=&quot;Enter URL&quot;    
        android:inputType=&quot;textUri&quot; /&gt;    

    &lt;Button    
        android:id=&quot;@+id/openButton&quot;    
        android:layout_width=&quot;wrap_content&quot;    
        android:layout_height=&quot;wrap_content&quot;    
        android:layout_below=&quot;@id/urlInput&quot;    
        android:layout_centerHorizontal=&quot;true&quot;    
        android:layout_marginTop=&quot;16dp&quot;    
        android:text=&quot;Open URL&quot; /&gt;    

&lt;/RelativeLayout&gt;
</code></pre>
<p>3.编写Java代码</p>
<p>在MainActivity.java中，你需要编写代码来处理按钮点击事件，并启动浏览器打开输入的URL。</p>
<pre><code class="language-Java">package com.example.yourappname;    

import android.content.Intent;    
import android.net.Uri;    
import android.os.Bundle;    
import android.view.View;    
import android.widget.Button;    
import android.widget.EditText;    

import androidx.appcompat.app.AppCompatActivity;    

public class MainActivity extends AppCompatActivity {    

    private EditText urlInput;    
    private Button openButton;    

    @Override    
    protected void onCreate(Bundle savedInstanceState) {    
        super.onCreate(savedInstanceState);    
        setContentView(R.layout.activity_main);    

        urlInput = findViewById(R.id.urlInput);    
        openButton = findViewById(R.id.openButton);    

        openButton.setOnClickListener(new View.OnClickListener() {    
            @Override    
            public void onClick(View v) {    
                String url = urlInput.getText().toString();    
                if (!url.startsWith(&quot;http://&quot;) &amp;&amp; !url.startsWith(&quot;https://&quot;)) {    
                    url = &quot;http://&quot; + url;    
                }    
                Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));    
                startActivity(intent);    
            }    
        });    
    }    
}  
</code></pre>
<p>这段代码中，我们为按钮设置了一个点击监听器，当点击按钮时，它会获取EditText中的文本，创建一个意图（Intent）来打开URL，并使用startActivity()方法启动浏览器。</p>
<p>4.测试应用</p>
<p>最后，构建并运行你的应用。你应该能够在模拟器或真实设备上输入一个URL，并点击按钮在浏览器中打开它。请确保你有适当的网络权限，尽管对于使用浏览器打开URL来说，这通常不是必需的。如果你打算在应用内部处理网络请求，你可能需要在AndroidManifest.xml中添加网络权限。</p>
<pre><code class="language-xml">&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;  
</code></pre>
<p>这就是一个基本的示例，展示如何在Android Studio中使用Java创建一个简单的应用来打开浏览器并导航到用户输入的URL。</p>
<hr />
<p><strong>操作：</strong></p>
<p>根据大模型的回答，我们了解了实现页面跳转的主要步骤：</p>
<p>1.我们新建Empty Activity，并将大模型提供的xml代码复制粘贴进activity_main.xml中，java代码复制粘贴进MainActivity.java，其中java代码</p>
<pre><code class="language-java">package com.example.yourappname;  
</code></pre>
<p>需要将"youappname"修改为你的文件名。也可以选择不复制粘贴这一行，直接保留Android studio生成的程序mainActivity中原有的这一行。</p>
<p>编译运行，可以得到一个页面中包含一个button以及一个可以输入URL的EditText，如下图所示。在EditText中输入URL，点击按钮，可以观察到页面跳转至浏览器并打开了输入的URL。</p>
<p><img alt="3-6" src="../fig03/3-6.png" /></p>
<!-- 图3-6 Intent跳转示例 -->

<h2 id="34-layout">3.4 Layout</h2>
<h3 id="341">3.4.1 布局方式简介</h3>
<p>在Android开发中，Layout类型用于定义界面布局的结构和样式。常见的Android Layout类型包括：（1）LinearLayout（线性布局），是一种简单的布局，它沿着水平或垂直方向排列子视图，可以通过orientation属性设置布局方向为水平或垂直。（2）RelativeLayout（相对布局），允许通过相对于其他视图的位置来放置子视图，子视图可以相对于父视图或其他子视图的位置进行定位；（3）ConstraintLayout（约束布局），是一种灵活的布局，允许通过约束将子视图相对于其他视图进行定位，可以通过拖动边界、设置边距和创建水平/垂直约束来定义布局；（4）FrameLayout（帧布局），允许子视图堆叠在一起，并且每个子视图都覆盖在前一个视图的上面，常用于在同一区域显示单个子视图，如Fragment或者加载动画；（5）GridLayout（网格布局），GridLayout将子视图放置在网格中，可以通过行和列的方式来组织视图，可以灵活地定义网格的行数、列数以及每个单元格的大小；（6）TableLayout（表格布局），允许以表格的形式排列子视图，可以定义多行和多列，并且每个单元格可以放置一个视图；（7）CoordinatorLayout（协调布局），CoordinatorLayout是一个增强的FrameLayout，用于实现复杂的用户界面交互效果，通过CoordinatorLayout可以实现诸如滚动效果、悬浮按钮动画等复杂的UI行为。</p>
<h3 id="342-constrain-layout">3.4.2 Constrain Layout（约束布局）</h3>
<p>ConstraintLayout（约束布局）是 Android 开发中最灵活和功能最强大的布局之一。它允许我们通过添加约束条件来定义视图之间的相对位置，而不是依赖于视图的层次结构。这种相对定位的方法使得设计复杂的界面变得更加简单和高效。这也是一般应用开发中最常用的布局模式，也是我最喜欢用的布局模式。
顾名思义，ConstraintLayout中有一些关键特性和用法：（1）相对定位，ConstraintLayout 允许我们将视图相对于父布局或其他视图进行定位。我们可以通过水平和垂直方向上的约束条件，指定视图与其它视图之间的位置关系。（2）约束条件：每个视图都可以与 ConstraintLayout 中的其他视图或者父布局的边界之间建立约束条件。这些约束条件可以是水平方向的对齐、垂直方向的对齐、边距、最小宽度、最小高度等。这个是在实际应用编写过程中非常常用的一个模式。（3）比例约束，ConstraintLayout 允许我们定义视图的尺寸为另一个视图尺寸的一个比例。这在确保界面在不同屏幕尺寸上保持一致性时非常有用。（4）可视性约束，我们可以根据条件动态更改视图的可见性，并在 ConstraintLayout 中定义这些视图的约束条件。这使得在用户交互或者其他条件下，动态地调整布局变得更加容易。（5）布局优化，ConstraintLayout 提供了优化布局层次结构的功能，可以减少布局层次的嵌套。这有助于提高应用的性能并简化布局的管理。</p>
<p>Android Studio中提供了一个可视化的布局编辑器，使得在 ConstraintLayout 中设计界面变得更加直观和方便。我们可以通过拖拽和调整视图来创建和编辑约束条件。不过我的建议就是大家在写应用的时候内心一定要有一个视图编辑器，写好约束条件后就可以在内心中知道布局会变成什么样子，这样对于可视化编辑是非常有用的。换句话说，大家心中现有一个要布局的样子，也要能够想到通过什么样的约束能够实现这样的布局效果，即使没有试图编辑器，也能实现约束布局的效果。</p>
<p>通过合理使用 ConstraintLayout，可以创建各种复杂的界面布局，约束布局还有一个好处就是由于是通过相对约束进行布局而不是绝对位置，能够使得这些布局在不同的屏幕尺寸和设备上都能够正常显示和运行。</p>
<h3 id="343">3.4.3 编辑器设计布局示例</h3>
<p>（1）目标</p>
<p>我们将要使用Constraint Layout设计一个简单的布局，如下左图：</p>
<ul>
<li>参考微信界面的案例，实现相应的布局</li>
<li>第一个部分有两个图标及位于其下的文字，分别是收付款和钱包</li>
<li>第二个部分是九宫格，每一个同样有图标及位于其下的文字，内容不限</li>
</ul>
<p>（2）实现过程</p>
<p>看到这个界面，我们先思考可以用什么样的布局方法实现，首先我们想到的就是可以用Linearlayout来实现，因为里面的元素到多数是比较规则的水平或者垂直的方式排列的。那如何开始这个布局呢，我们可以试着让大模型来帮助我们。我们可以将这个图片给大模型，看看大模型会给我们什么样的答案。注意，现在很多大模型都支持多模态，不仅是能够支持文字输入，还支持图片等其他形式的文件输入。</p>
<p>我们首先创建一个空项目，选择Empty Views Activity，项目名称任意，其他保持默认。然后，我们在Android Studio里面双击activity_main.xml文件，使用自带的编辑器来进行编辑。我们通过尝试发现，使用大模型来设计好布局还是很难的，可能在大模型中还没有完全理解布局这一理念，希望未来大模型能够更加好的适应这一块。对于布局文件来说，让大模型按照需求绘制界面远没有使用可视化的编辑器来的简单。</p>
<p>对于这个目标我们首先确定总体的界面结构：这个界面有两个部分，第一个部分有两个图标及位于其下的文字，分别是收付款和钱包，第二个部分是九宫格，每一个同样有图标及位于其下的文字。因此我们可以用两个LinearLayout来分别表示第一个和第二个部分。以此类推，第一部分又可以分为左右两个图标，而第二部分又可以分为9个图标，每个图标可以分别使用一个TextView来实现，或者拆分为一个图标和一个标签。9个图标同样可以使用3个LinearLayout或者一个GridLayout来组织，依据实际情况而定。</p>
<p>默认的基础布局是ConstrainLayout，因此我们从左边的组件中拖入LinearLayout，并设置与父组件（即ConstrainLayout）的约束，我们可以通过可视化工具来设置，如下图所示：</p>
<p><img alt="3-7" src="../fig03/3-7.png" /></p>
<!-- 图3-7 可视化布局 -->

<p>可以通过拖动界面中的组件四边蓝点来添加和其他组件之间的约束，并在右边的工具栏中设置相关的约束值。这里我们定义了该LinearLayout的上边和父组件上边的约束为间距8dp、该LinearLayout的左边和父组件左边的约束为间距8dp，以及该LinearLayout的右边和父组件右边的约束为间距8dp。在Android中，上下左右分别被定义为Top、Bottom、Start和End。</p>
<p>同时，我们也可以在右边的工具栏中修改任意选中组件的属性，如文字内容、图标等等。在这个例子中，下面的每个图标组件都是用一个TextView实现，并定义了android:text和app:drawableTopCompat，从而绘制出一个图标按钮。</p>
<p>同样这些约束和属性也可以在xml代码中进行修改，例如：</p>
<pre><code class="language-xml">&lt;TextView  
    android:id=&quot;@+id/textView5&quot;  
    android:layout_width=&quot;0dp&quot;  
    android:layout_height=&quot;wrap_content&quot;  
    android:layout_weight=&quot;1&quot;  
    android:paddingTop=&quot;30dp&quot;  
    android:paddingBottom=&quot;30dp&quot;  
    android:text=&quot;信用卡还款&quot;  
    android:textAlignment=&quot;center&quot;  
    app:drawableTopCompat=&quot;@drawable/ic_credit&quot; /&gt;  
</code></pre>
<p>依据要求依次通过可视化编辑器或者代码定义组件及其约束。</p>
<p>（3）运行示例</p>
<p>如下图所示，实机结果与编辑器中预览结果一致。</p>
<p><img alt="3-8" src="../fig03/3-8.png" /></p>
<!-- 图3-8 Android Studio实现界面 -->

<h3 id="344">3.4.4 大模型设计布局示例</h3>
<p>目标：我们将使用大模型实现上述的布局样例。通常情况下，程序员会从设计人员那边拿到界面的<strong>原型设计</strong>，如果能借助大模型的能力直接从界面图片中生成相关的代码，想必会极大地提高效率。</p>
<p>我们首先创建一个空项目，选择Empty Views Activity，项目名称任意，其他保持默认。对于该项任务，我们需要充分利用大模型的多模态能力。</p>
<p><strong>交互过程1：目标输入</strong></p>
<p><strong>用户：</strong></p>
<p>可以帮我在移动应用开发过程中，实现这样的一个布局效果吗？</p>
<p><img src="fig03/3-8.png" alt="3-7" style="zoom:20%; border: 1px solid; border-radius: 5%;" /></p>
<hr />
<p>注意，我们将图片直接输入给了大模型，就在我们最开始准备这个材料的时候，大部分的大模型还不支持图片作为输入，而到现在，大量的大模型都支持图片输入了，都可以来分析理解图片，我们就展示一个案例，看看大模型怎么学习一个设计好的界面的效果，然后帮助来设计相关的布局。</p>
<p><strong>大模型：</strong></p>
<p>当然可以！下面是一个简单的示例，展示如何使用Android的XML布局文件来实现类似的界面布局。这个示例使用了<code>ConstraintLayout</code>来实现复杂的布局需求。</p>
<p>1.创建一个新的XML布局文件</p>
<p>在你的Android项目的<code>res/layout</code>目录下创建一个新的XML文件，例如<code>activity_main.xml</code>。</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    tools:context=&quot;.MainActivity&quot;&gt;

    &lt;!-- Header Section --&gt;
    &lt;LinearLayout
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:orientation=&quot;horizontal&quot;
        android:background=&quot;#00C853&quot;
        android:padding=&quot;16dp&quot;
        app:layout_constraintTop_toTopOf=&quot;parent&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&gt;

        &lt;ImageView
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:src=&quot;@drawable/ic_payment&quot; /&gt;

        &lt;TextView
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:text=&quot;收付款&quot;
            android:textColor=&quot;#FFFFFF&quot;
            android:layout_marginStart=&quot;16dp&quot;
            android:textSize=&quot;18sp&quot; /&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_weight=&quot;1&quot;
            android:gravity=&quot;end&quot;
            android:orientation=&quot;vertical&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_wallet&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;钱包&quot;
                android:textColor=&quot;#FFFFFF&quot;
                android:layout_marginTop=&quot;4dp&quot;
                android:textSize=&quot;14sp&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;¥9.25&quot;
                android:textColor=&quot;#FFFFFF&quot;
                android:textSize=&quot;16sp&quot; /&gt;
        &lt;/LinearLayout&gt;
    &lt;/LinearLayout&gt;

    &lt;!-- Service Section --&gt;
    &lt;TextView
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:text=&quot;腾讯服务&quot;
        android:textSize=&quot;16sp&quot;
        android:padding=&quot;16dp&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/header&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot; /&gt;

    &lt;GridLayout
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:columnCount=&quot;3&quot;
        android:rowCount=&quot;2&quot;
        android:layout_margin=&quot;16dp&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/title&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_credit_card&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;信用卡还款&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_phone&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;手机充值&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_finance&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;理财通&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_life_pay&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;生活缴费&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_q_coin&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;Q币充值&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_city_service&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;城市服务&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;
    &lt;/GridLayout&gt;

    &lt;LinearLayout
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:orientation=&quot;vertical&quot;
        android:gravity=&quot;center&quot;
        android:padding=&quot;16dp&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/gridLayout&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&gt;

        &lt;ImageView
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:src=&quot;@drawable/ic_charity&quot; /&gt;

        &lt;TextView
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:text=&quot;腾讯公益&quot;
            android:textSize=&quot;14sp&quot;
            android:layout_marginTop=&quot;8dp&quot; /&gt;
    &lt;/LinearLayout&gt;

&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;
</code></pre>
<p>2.添加图标资源</p>
<p>确保在你的<code>res/drawable</code>目录下添加相应的图标资源文件，例如<code>ic_payment</code>、<code>ic_wallet</code>、<code>ic_credit_card</code>等。</p>
<p>3.在MainActivity中设置布局</p>
<p>在你的<code>MainActivity.java</code>中设置布局：</p>
<pre><code class="language-java">package com.example.yourapp;

import androidx.appcompat.app.AppCompatActivity;
import android.os.Bundle;

public class MainActivity extends AppCompatActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }
}
</code></pre>
<p>4.运行应用</p>
<p>现在你可以运行你的应用，应该能看到类似于你提供的界面布局效果。</p>
<p>这个示例只是一个基本的实现，你可以根据需要进一步调整样式和功能。例如，你可以添加点击事件、动态数据加载等。希望这对你有帮助！</p>
<hr />
<p><strong>操作：</strong></p>
<p>我们根据对话内容依次进行以下操作：</p>
<ul>
<li>将大模型提供的XML代码复制到<code>activity_main.xml</code>文件中</li>
</ul>
<p>添加代码后，发现IDE报错：<code>The id "header" is not defined anywhere.</code>，如图X-X所示：</p>
<p><img alt="" src="../fig03/layout_1_error.png" /></p>
<p>这个问题如果是熟悉布局使用的开发者，应该能够比较快的发现主要原因，其实就是前面的相对参考的layout没有设置id，我们补充上id就可以。不过我们也可以基于大模型，在大模型的帮助下来帮我们完成相关事情，因此我们再次询问大模型。</p>
<hr />
<p><strong>交互过程2：解决报错</strong></p>
<p><strong>用户：</strong></p>
<p>出现了报错：<code>The id "header" is not defined anywhere.</code></p>
<hr />
<p><strong>大模型：</strong></p>
<p>抱歉，我在示例代码中使用了一个未定义的ID <code>header</code>。让我修正这个问题并提供一个更新的示例。</p>
<p>更新的XML布局文件</p>
<p>在你的<code>res/layout</code>目录下创建或更新<code>activity_main.xml</code>文件：</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    tools:context=&quot;.MainActivity&quot;&gt;

    &lt;!-- Header Section --&gt;
    &lt;LinearLayout
        android:id=&quot;@+id/header&quot;
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:orientation=&quot;horizontal&quot;
        android:background=&quot;#00C853&quot;
        android:padding=&quot;16dp&quot;
        app:layout_constraintTop_toTopOf=&quot;parent&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&gt;

        &lt;ImageView
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:src=&quot;@drawable/ic_payment&quot; /&gt;

        &lt;TextView
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:text=&quot;收付款&quot;
            android:textColor=&quot;#FFFFFF&quot;
            android:layout_marginStart=&quot;16dp&quot;
            android:textSize=&quot;18sp&quot; /&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_weight=&quot;1&quot;
            android:gravity=&quot;end&quot;
            android:orientation=&quot;vertical&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_wallet&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;钱包&quot;
                android:textColor=&quot;#FFFFFF&quot;
                android:layout_marginTop=&quot;4dp&quot;
                android:textSize=&quot;14sp&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;¥9.25&quot;
                android:textColor=&quot;#FFFFFF&quot;
                android:textSize=&quot;16sp&quot; /&gt;
        &lt;/LinearLayout&gt;
    &lt;/LinearLayout&gt;

    &lt;!-- Service Section --&gt;
    &lt;TextView
        android:id=&quot;@+id/title&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:text=&quot;腾讯服务&quot;
        android:textSize=&quot;16sp&quot;
        android:padding=&quot;16dp&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/header&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot; /&gt;

    &lt;GridLayout
        android:id=&quot;@+id/gridLayout&quot;
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:columnCount=&quot;3&quot;
        android:rowCount=&quot;2&quot;
        android:layout_margin=&quot;16dp&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/title&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_credit_card&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;信用卡还款&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_phone&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;手机充值&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_finance&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;理财通&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_life_pay&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;生活缴费&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_q_coin&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;Q币充值&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_city_service&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;城市服务&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;
    &lt;/GridLayout&gt;

    &lt;LinearLayout
        android:id=&quot;@+id/charityLayout&quot;
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:orientation=&quot;vertical&quot;
        android:gravity=&quot;center&quot;
        android:padding=&quot;16dp&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/gridLayout&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&gt;

        &lt;ImageView
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:src=&quot;@drawable/ic_charity&quot; /&gt;

        &lt;TextView
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:text=&quot;腾讯公益&quot;
            android:textSize=&quot;14sp&quot;
            android:layout_marginTop=&quot;8dp&quot; /&gt;
    &lt;/LinearLayout&gt;

&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;
</code></pre>
<p>3.在MainActivity中设置布局</p>
<p>在你的<code>MainActivity.java</code>中设置布局：</p>
<pre><code class="language-java">package com.example.yourapp;

import androidx.appcompat.app.AppCompatActivity;
import android.os.Bundle;

public class MainActivity extends AppCompatActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }
}
</code></pre>
<p>4.添加图标资源</p>
<p>确保在你的<code>res/drawable</code>目录下添加相应的图标资源文件，例如<code>ic_payment</code>、<code>ic_wallet</code>、<code>ic_credit_card</code>等。</p>
<p>5.运行应用</p>
<p>现在你可以运行你的应用，应该能看到类似于你提供的界面布局效果。</p>
<p>这个示例只是一个基本的实现，你可以根据需要进一步调整样式和功能。例如，你可以添加点击事件、动态数据加载等。希望这对你有帮助！</p>
<hr />
<p><strong>操作：</strong></p>
<p>我们根据对话内容依次将大模型提供的XML代码复制到<code>activity_main.xml</code>文件中，此时可以看到界面渲染如下所示：</p>
<p><img alt="" src="../fig03/layout_2_wo_ic.png" /></p>
<p>在这个基本框架上，进一步地把图标资源导入，可以看到如下图的效果</p>
<p><img alt="" src="../fig03/layout_2_w_ic.png" /></p>
<p>这时候我们可以看到，跟我们最后要的效果还差得很远，这时候不要着急，不要慌，我们继续来调整一步一步来解决问题。如果有一些布局设置经验的开发者，其实到这一步可以自己来慢慢调整了，例如这里面很多图标重叠，肯定是相对位置设置得不太对。不过我们也可以继续询问大模型出了什么问题。</p>
<hr />
<p><strong>交互过程3：解决布局紊乱</strong></p>
<p><strong>用户：</strong></p>
<p>现在的界面结构长这个样子，要怎么进一步修改。</p>
<p><img src="fig03/layout_2_w_ic.png" style="zoom:33%; border: 1px solid; border-radius: 5%" /></p>
<hr />
<p><strong>大模型：</strong></p>
<p>根据您提供的新的界面结构，我们需要对布局进行一些调整。以下是更新后的XML布局文件，适用于Android应用开发。</p>
<p>更新的XML布局文件</p>
<p>在您的<code>res/layout</code>目录下创建或更新<code>activity_main.xml</code>文件：</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    tools:context=&quot;.MainActivity&quot;&gt;

    &lt;!-- Header Section --&gt;
    &lt;LinearLayout
        android:id=&quot;@+id/header&quot;
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:orientation=&quot;horizontal&quot;
        android:background=&quot;#00C853&quot;
        android:padding=&quot;16dp&quot;
        app:layout_constraintTop_toTopOf=&quot;parent&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&gt;

        &lt;ImageView
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:src=&quot;@drawable/ic_android&quot; /&gt;

        &lt;TextView
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_weight=&quot;1&quot;
            android:text=&quot;收付款&quot;
            android:textColor=&quot;#FFFFFF&quot;
            android:gravity=&quot;center&quot;
            android:textSize=&quot;18sp&quot; /&gt;

        &lt;LinearLayout
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_wallet&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;钱包&quot;
                android:textColor=&quot;#FFFFFF&quot;
                android:layout_marginTop=&quot;4dp&quot;
                android:textSize=&quot;14sp&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;¥9.25&quot;
                android:textColor=&quot;#FFFFFF&quot;
                android:textSize=&quot;16sp&quot; /&gt;
        &lt;/LinearLayout&gt;
    &lt;/LinearLayout&gt;

    &lt;!-- Service Section --&gt;
    &lt;TextView
        android:id=&quot;@+id/title&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:text=&quot;腾讯服务&quot;
        android:textSize=&quot;16sp&quot;
        android:padding=&quot;16dp&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/header&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot; /&gt;

    &lt;GridLayout
        android:id=&quot;@+id/gridLayout&quot;
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:columnCount=&quot;3&quot;
        android:rowCount=&quot;3&quot;
        android:layout_margin=&quot;16dp&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/title&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot;&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_credit_card&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;信用卡还款&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_phone&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;手机充值&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_finance&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;理财通&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_life_pay&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;生活缴费&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_q_coin&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;Q币充值&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_city_service&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;城市服务&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:orientation=&quot;vertical&quot;
            android:gravity=&quot;center&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_charity&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;腾讯公益&quot;
                android:textSize=&quot;14sp&quot;
                android:layout_marginTop=&quot;8dp&quot; /&gt;
        &lt;/LinearLayout&gt;
    &lt;/GridLayout&gt;

&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;
</code></pre>
<p>3.在MainActivity中设置布局</p>
<p>在您的<code>MainActivity.java</code>中设置布局：</p>
<pre><code class="language-java">package com.example.yourapp;

import androidx.appcompat.app.AppCompatActivity;
import android.os.Bundle;

public class MainActivity extends AppCompatActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }
}
</code></pre>
<p>4.添加图标资源</p>
<p>确保在您的<code>res/drawable</code>目录下添加相应的图标资源文件，例如<code>ic_android</code>、<code>ic_wallet</code>、<code>ic_credit_card</code>等。</p>
<p>5.运行应用</p>
<p>现在您可以运行您的应用，应该能看到类似于您提供的界面布局效果。</p>
<p>这个示例只是一个基本的实现，您可以根据需要进一步调整样式和功能。例如，您可以添加点击事件、动态数据加载等。希望这对您有帮助！</p>
<hr />
<p><strong>操作：</strong></p>
<p>我们根据对话内容依次进行以下操作：</p>
<ul>
<li>再次将大模型提供的XML代码复制到<code>activity_main.xml</code>文件中</li>
</ul>
<p>此时可以看到界面渲染如下图所示：</p>
<p><img alt="" src="../fig03/layout_3.png" /></p>
<p>可以看到，现在界面已经基本符合需求，手动修改以下最前面的图标命名错误并给定大小，再修复一些头部的Bug，修改后的xml文件如下：</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;!-- 这边头部需要加上ID --&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:id=&quot;@+id/main&quot;                                               
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    tools:context=&quot;.MainActivity&quot;&gt;

    &lt;!-- Header Section --&gt;
    &lt;LinearLayout
        android:id=&quot;@+id/header&quot;
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:background=&quot;#00C853&quot;
        android:orientation=&quot;horizontal&quot;
        android:padding=&quot;16dp&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintTop_toTopOf=&quot;parent&quot;&gt;

        &lt;!-- 这边模仿下面的代码加上LinearLayout --&gt;
        &lt;LinearLayout
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:gravity=&quot;center&quot;
            android:orientation=&quot;vertical&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;42sp&quot;
                android:src=&quot;@drawable/ic_payment&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:layout_weight=&quot;1&quot;
                android:gravity=&quot;center&quot;
                android:text=&quot;收付款&quot;
                android:textColor=&quot;#FFFFFF&quot;
                android:textSize=&quot;18sp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;!-- 这边把宽度改成正确的宽度 --&gt;
        &lt;LinearLayout
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:gravity=&quot;center&quot;
            android:orientation=&quot;vertical&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;42sp&quot;
                android:src=&quot;@drawable/ic_wallet&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:layout_marginTop=&quot;4dp&quot;
                android:text=&quot;钱包&quot;
                android:textColor=&quot;#FFFFFF&quot;
                android:textSize=&quot;14sp&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:text=&quot;¥9.25&quot;
                android:textColor=&quot;#FFFFFF&quot;
                android:textSize=&quot;16sp&quot; /&gt;
        &lt;/LinearLayout&gt;
    &lt;/LinearLayout&gt;

    &lt;!-- Service Section --&gt;
    &lt;TextView
        android:id=&quot;@+id/title&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:padding=&quot;16dp&quot;
        android:text=&quot;腾讯服务&quot;
        android:textSize=&quot;16sp&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/header&quot; /&gt;

    &lt;GridLayout
        android:id=&quot;@+id/gridLayout&quot;
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_margin=&quot;16dp&quot;
        android:columnCount=&quot;3&quot;
        android:rowCount=&quot;3&quot;
        app:layout_constraintEnd_toEndOf=&quot;parent&quot;
        app:layout_constraintStart_toStartOf=&quot;parent&quot;
        app:layout_constraintTop_toBottomOf=&quot;@id/title&quot;&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:gravity=&quot;center&quot;
            android:orientation=&quot;vertical&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_credit_card&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:layout_marginTop=&quot;8dp&quot;
                android:text=&quot;信用卡还款&quot;
                android:textSize=&quot;14sp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:gravity=&quot;center&quot;
            android:orientation=&quot;vertical&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_phone&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:layout_marginTop=&quot;8dp&quot;
                android:text=&quot;手机充值&quot;
                android:textSize=&quot;14sp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:gravity=&quot;center&quot;
            android:orientation=&quot;vertical&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_finance&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:layout_marginTop=&quot;8dp&quot;
                android:text=&quot;理财通&quot;
                android:textSize=&quot;14sp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:gravity=&quot;center&quot;
            android:orientation=&quot;vertical&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_life_pay&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:layout_marginTop=&quot;8dp&quot;
                android:text=&quot;生活缴费&quot;
                android:textSize=&quot;14sp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:gravity=&quot;center&quot;
            android:orientation=&quot;vertical&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_q_coin&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:layout_marginTop=&quot;8dp&quot;
                android:text=&quot;Q币充值&quot;
                android:textSize=&quot;14sp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:gravity=&quot;center&quot;
            android:orientation=&quot;vertical&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_city_service&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:layout_marginTop=&quot;8dp&quot;
                android:text=&quot;城市服务&quot;
                android:textSize=&quot;14sp&quot; /&gt;
        &lt;/LinearLayout&gt;

        &lt;LinearLayout
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_columnWeight=&quot;1&quot;
            android:gravity=&quot;center&quot;
            android:orientation=&quot;vertical&quot;
            android:padding=&quot;16dp&quot;&gt;

            &lt;ImageView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:src=&quot;@drawable/ic_charity&quot; /&gt;

            &lt;TextView
                android:layout_width=&quot;wrap_content&quot;
                android:layout_height=&quot;wrap_content&quot;
                android:layout_marginTop=&quot;8dp&quot;
                android:text=&quot;腾讯公益&quot;
                android:textSize=&quot;14sp&quot; /&gt;
        &lt;/LinearLayout&gt;
    &lt;/GridLayout&gt;

&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;
</code></pre>
<p>（3）运行示例</p>
<p>编译运行程序后看到的界面如下图所示，这时候我们就得到了一个相对比较清晰的布局设计了，在此基础上，我们可以在进一步调整，这样就可以得到更好的效果。对于其他的布局也是一样。</p>
<p><strong>从总体上来看，布局设计的时候与大模型直接进行多模态图片交互，通常很难一下子得到想要的效果，对于复杂的效果可能大模型给出的方法跟实际我们想要的效果差别还很大，这就很需要开发者对布局有相应的了解，基于了解将任务进行分解，或者对大模型给出的答案进行修改优化。</strong></p>
<p><img alt="" src="../fig03/layout_final.png" /></p>
<h2 id="35-listener">3.5 Listener</h2>
<p><strong>Listener是Android中用于处理用户交互和事件响应的机制，是事件处理机制的核心组件之一，是让应用“活”起来的关键。</strong>
它允许开发者监听并响应用户与界面交互时产生的各种事件，如用户的交互（点击、触摸、按键等）、数据变化或系统状态的变更。通过使用Listener类，开发者可以为不同的控件（如按钮、文本框等）设置相应的事件处理逻辑，从而实现丰富的交互功能。理解和使用监听器是开发响应式和互动性强的应用程序的关键。</p>
<h3 id="351">3.5.1 监听器的概念</h3>
<p>监听器是一种接口（Interface），用于定义特定事件发生时的回调方法。当用户与界面交互（如点击按钮、触摸屏幕、输入文本等）时，或是数据和系统状态发生变化时，Android系统会触发相应的事件，并调用监听器接口中定义的方法。开发者可以在这些回调方法中编写具体的处理逻辑，从而实现对事件的响应。</p>
<h3 id="352">3.5.2 监听器的作用</h3>
<p>监听器的主要作用是将用户操作（事件）与具体的处理逻辑解耦。通过监听器，开发者可以灵活地为不同的控件设置不同的事件处理逻辑，而无需在控件的代码中直接编写事件处理代码。这种设计模式使得代码更加清晰、模块化，便于维护和扩展。</p>
<h3 id="353">3.5.3 监听器的工作原理</h3>
<p>监听器的工作原理基于事件驱动编程模型，具体流程如下：</p>
<ol>
<li><strong>事件源（Event Source）</strong>：事件源是指能够产生事件的对象，通常是界面中的控件（如按钮、文本框等）。</li>
<li><strong>事件（Event）</strong>：事件是指用户与界面交互时产生的动作，如点击、触摸、按键等。</li>
<li><strong>监听器（Listener）</strong>：监听器是一个接口，定义了事件发生时需要执行的回调方法。</li>
<li><strong>事件分发（Event Dispatch）</strong>：当事件发生时，Android系统会将事件分发到对应的事件源。</li>
<li><strong>事件处理（Event Handling）</strong>：事件源会调用监听器接口中定义的回调方法，并将事件的相关信息传递给该方法。开发者可以在回调方法中编写具体的处理逻辑。</li>
</ol>
<h3 id="354">3.5.4 常见的监听器类型</h3>
<p>在移动应用开发中，有几种常见的监听器类型：（1）用户交互监听器，如点击监听器、触摸监听器、滚动监听器等；（2）数据监听器，如数据变化监听器、数据库监听器等；（3）系统事件监听器，如电池状态监听器、网络状态监听器等。</p>
<p>（1）用户交互监听器</p>
<p>用户交互监听器用于监听用户与界面控件的交互事件，如点击、触摸、长按等。这些监听器通常绑定到UI控件上，用于响应用户的操作。</p>
<p>以下是一些常见的用户交互监听器及其用途：</p>
<ul>
<li><strong><code>View.OnClickListener</code></strong>：用于监听控件的点击事件。</li>
<li><strong><code>View.OnLongClickListener</code></strong>：用于监听控件的长按事件。</li>
<li><strong><code>View.OnTouchListener</code></strong>：监听控件的触摸事件，包括按下、移动、抬起等。</li>
<li><strong><code>AdapterView.OnItemClickListener</code></strong>：用于监听列表项的点击事件。</li>
</ul>
<p>（2）数据监听器</p>
<p>数据监听器用于监听数据的变化，通常用于实现数据绑定和响应式编程。</p>
<p>以下是一些常见的数据监听器及其用途：</p>
<ul>
<li>
<p><strong><code>TextWatcher</code></strong>：监听文本框（<code>EditText</code>）内容的变化。</p>
</li>
<li>
<p><strong><code>CompoundButton.OnCheckedChangeListener</code> </strong>：监听复选框（<code>CheckBox</code>）或单选按钮（<code>RadioButton</code>）的选中状态变化。</p>
</li>
<li>
<p><strong><code>SeekBar.OnSeekBarChangeListener</code></strong>：监听进度条（<code>SeekBar</code>）的变化。</p>
</li>
</ul>
<p>（3）系统事件监听器</p>
<p>系统事件监听器用于监听系统层面的事件，如生命周期事件、配置变化、电池状态等。</p>
<p>以下是一些常见的系统事件监听器及其用途：</p>
<ul>
<li><strong><code>ActivityLifecycleCallbacks</code></strong>：监听Activity的生命周期事件。</li>
<li><strong><code>BroadcastReceiver</code></strong>：监听系统广播事件，如电池状态变化、网络状态变化等。</li>
<li><strong><code>OnSharedPreferenceChangeListener</code></strong>：监听<code>SharedPreferences</code>中数据的变化。</li>
</ul>
<p>合理使用这些监听器可以提升应用程序的交互性和用户体验，同时也可以更好地管理应用的全局状态和系统资源。</p>
<h3 id="355">3.5.5. 监听器的注册方式</h3>
<p>要使用监听器，必须先为控件注册监听器。Android提供了多种注册监听器的方式，常见的有以下几种：</p>
<h4 id="1">（1）匿名内部类</h4>
<p>通过匿名内部类实现监听器接口，并直接为控件设置监听器。这种方式简洁明了，适合处理逻辑较简单的场景。</p>
<pre><code class="language-java">button.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        // 处理点击事件
        Toast.makeText(context, &quot;按钮被点击了&quot;, Toast.LENGTH_SHORT).show();
    }
});
</code></pre>
<h4 id="2">（2）内部类</h4>
<p>通过定义一个内部类实现监听器接口，然后将内部类的实例设置为控件的监听器。这种方式可以使代码更加清晰，适合处理逻辑较复杂的场景。</p>
<pre><code class="language-java">private class MyClickListener implements View.OnClickListener {
    @Override
    public void onClick(View v) {
        // 处理点击事件
        Toast.makeText(context, &quot;按钮被点击了&quot;, Toast.LENGTH_SHORT).show();
    }
}

button.setOnClickListener(new MyClickListener());
</code></pre>
<h4 id="3_1">（3）外部类</h4>
<p>将监听器实现为一个独立的外部类，然后在需要的地方创建其实例并注册到控件上。这种方式可以使代码更加模块化，便于复用。</p>
<pre><code class="language-java">public class MyClickListener implements View.OnClickListener {
    @Override
    public void onClick(View v) {
        // 处理点击事件
        Toast.makeText(v.getContext(), &quot;按钮被点击了&quot;, Toast.LENGTH_SHORT).show();
    }
}

button.setOnClickListener(new MyClickListener());
</code></pre>
<h4 id="4activityfragment">（4）Activity或Fragment自身实现接口</h4>
<p>让Activity或Fragment自身实现监听器接口，并在需要的地方将自身设置为控件的监听器。这种方式可以使代码更加简洁，但需要注意避免混淆。</p>
<pre><code class="language-java">public class MainActivity extends AppCompatActivity implements View.OnClickListener {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Button button = findViewById(R.id.button);
        button.setOnClickListener(this);
    }

    @Override
    public void onClick(View v) {
        // 处理点击事件
        Toast.makeText(this, &quot;按钮被点击了&quot;, Toast.LENGTH_SHORT).show();
    }
}
</code></pre>
<h4 id="5xml">（5）通过XML设置</h4>
<p>在布局文件中通过<code>android:onClick</code>属性指定一个方法名，该方法将在点击事件发生时被调用。这种方式可以使代码更加简洁，但灵活性相对较低。</p>
<pre><code class="language-xml">&lt;Button
    android:id=&quot;@+id/button&quot;
    android:layout_width=&quot;wrap_content&quot;
    android:layout_height=&quot;wrap_content&quot;
    android:text=&quot;点击我&quot;
    android:onClick=&quot;onButtonClick&quot; /&gt;
</code></pre>
<pre><code class="language-java">public class MainActivity extends AppCompatActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    public void onButtonClick(View v) {
        // 处理点击事件
        Toast.makeText(this, &quot;按钮被点击了&quot;, Toast.LENGTH_SHORT).show();
    }
}
</code></pre>
<h3 id="356">3.5.6 监听器的回调方法</h3>
<p>监听器接口通常定义了一个或多个回调方法，这些方法会在特定事件发生时被调用。例如：</p>
<ul>
<li><code>View.OnClickListener</code>的<code>onClick(View v)</code>方法会在控件被点击时被调用。</li>
<li><code>View.OnLongClickListener</code>的<code>onLongClick(View v)</code>方法会在控件被长按时被调用。</li>
<li><code>View.OnKeyListener</code>的<code>onKey(View v, int keyCode, KeyEvent event)</code>方法会在按键事件发生时被调用。</li>
</ul>
<p>开发者需要在这些回调方法中编写具体的事件处理逻辑。例如：</p>
<pre><code class="language-java">button.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        // 处理点击事件
        Toast.makeText(context, &quot;按钮被点击了&quot;, Toast.LENGTH_SHORT).show();
    }
});
</code></pre>
<h3 id="358-listener">3.5.8  大模型使用Listener案例</h3>
<p>目标：我们将实现拖拽方块的功能，来体现Listener的基本使用方式。</p>
<p>我们首先创建一个空项目，选择Empty Views Activity，项目名称任意，其他保持默认。</p>
<p><strong>交互过程1：目标输入</strong></p>
<p><strong>用户：</strong></p>
<p>请给我一个安卓Java使用Listener拖动方块的示例。</p>
<p><strong>大模型：</strong></p>
<p>以下是一个简单的安卓Java示例代码，用于实现通过监听器（Listener）拖动方块的功能。这个示例使用了一个自定义的<code>View</code>来绘制方块，并通过触摸事件来实现方块的拖动。</p>
<p><strong>示例代码</strong></p>
<p>1.创建一个自定义的<code>View</code>类</p>
<p>这个类负责绘制方块，并处理触摸事件以实现拖动功能。</p>
<pre><code class="language-java">import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.util.AttributeSet;
import android.view.MotionEvent;
import android.view.View;

public class DraggableSquareView extends View {
    private float squareX = 100; // 方块的初始X坐标
    private float squareY = 100; // 方块的初始Y坐标
    private float squareSize = 100; // 方块的大小
    private Paint paint; // 用于绘制方块的画笔
    private boolean isDragging = false; // 是否正在拖动
    private float touchOffsetX; // 触摸点与方块左上角的X偏移量
    private float touchOffsetY; // 触摸点与方块左上角的Y偏移量

    public DraggableSquareView(Context context, AttributeSet attrs) {
        super(context, attrs);
        init();
    }

    private void init() {
        paint = new Paint();
        paint.setColor(Color.BLUE); // 设置方块颜色为
蓝色    }

    @Override
    protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);
        // 绘制方块
        canvas.drawRect(squareX, squareY, squareX + squareSize, squareY + squareSize, paint);
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        switch (event.getAction()) {
            case MotionEvent.ACTION_DOWN:
                // 检测触摸点是否在方块内
                if (event.getX() &gt;= squareX &amp;&amp; event.getX() &lt;= squareX + squareSize &amp;&amp;
                    event.getY() &gt;= squareY &amp;&amp; event.getY() &lt;= squareY + squareSize) {
                    isDragging = true;
                    touchOffsetX = event.getX() - squareX; // 计算触摸点与方块左上角的X偏移量
                    touchOffsetY = event.getY() - squareY; // 计算触摸点与方块左上角的Y偏移量
                }
                break;
            case MotionEvent.ACTION_MOVE:
                if (isDragging) {
                    // 更新方块的位置
                    squareX = event.getX() - touchOffsetX;
                    squareY = event.getY() - touchOffsetY;
                    invalidate(); // 重绘视图
                }
                break;
            case MotionEvent.ACTION_UP:
                if (isDragging) {
                    isDragging = false;
                }
                break;
        }
        return true;
    }
}
</code></pre>
<p>2.在布局文件中使用自定义的<code>View</code></p>
<p>在<code>res/layout/activity_main.xml</code>中添加自定义的<code>DraggableSquareView</code>。</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    tools:context=&quot;.MainActivity&quot;&gt;

    &lt;com.example.draggable.DraggableSquareView
        android:id=&quot;@+id/draggable_square&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;match_parent&quot; /&gt;

&lt;/RelativeLayout&gt;
</code></pre>
<p>3.在<code>MainActivity</code>中初始化</p>
<p>在<code>MainActivity</code>中不需要额外的代码，因为自定义的<code>View</code>已经处理了所有的逻辑。</p>
<pre><code class="language-java">import android.os.Bundle;
import androidx.appcompat.app.AppCompatActivity;

public class MainActivity extends AppCompatActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }
}
</code></pre>
<p><strong>运行效果</strong></p>
<p>运行这个应用后，屏幕上会显示一个蓝色的方块。你可以通过触摸并拖动方块来改变它的位置。这个示例通过<code>onTouchEvent</code>方法监听触摸事件，并根据触摸点的位置动态更新方块的位置。</p>
<p><strong>注意事项</strong></p>
<ul>
<li>如果方块的大小或位置需要动态调整，可以在<code>DraggableSquareView</code>类中添加相应的逻辑。</li>
<li>如果需要更复杂的交互（例如限制方块的移动范围），可以在<code>ACTION_MOVE</code>事件中添加额外的逻辑来限制方块的位置。</li>
</ul>
<p><strong>操作：</strong></p>
<p>根据大模型的输出，我们进行以下操作：</p>
<ul>
<li>创建一个新的类<code>DraggableSquareView</code>，并把代码复制进相应文件中</li>
<li>将XML代码复制到<code>activity_main.xml</code>文件中</li>
</ul>
<blockquote>
<p>记得保持<code>package</code>包名。</p>
<p>记得修改奇怪的但是很小的Bug。</p>
</blockquote>
<p>（3）运行示例</p>
<p>拖拽前：</p>
<p><img alt="" src="../fig03/listener_before.png" /></p>
<p><img alt="" src="../fig03/listener_after.png" /></p>
<h3 id="359">3.5.9 总结</h3>
<p>监听器是Android开发中实现事件处理的核心机制。通过监听器，开发者可以灵活地为控件设置事件处理逻辑，实现丰富的交互功能。合理使用监听器可以提高代码的可读性和可维护性，同时需要注意避免内存泄漏、线程安全等问题。</p>
<h2 id="36-fragment">3.6 Fragment</h2>
<p><strong>Fragment是Android开发中用于构建动态和模块化用户界面的重要组件，是实现复杂界面布局和功能模块化的强大工具。</strong>
本章将讲解Fragment的生命周期、如何在Activity中使用Fragment，以及Fragment与Activity之间的通信方式。</p>
<h3 id="361-fragment">3.6.1 Fragment介绍</h3>
<p><code>Fragment</code> 是Android开发中用于构建动态和模块化用户界面的重要组件。它可以嵌入到 <code>Activity</code> 中，从而实现更灵活的界面布局和功能模块化。<code>Fragment</code> 有自己的生命周期，类似于 <code>Activity</code>，但更加灵活，可以独立于 <code>Activity</code> 被添加、移除或替换。</p>
<h3 id="361-fragment_1">3.6.1 Fragment的特性</h3>
<h4 id="1_1"><strong>（1）模块化与复用性</strong></h4>
<ul>
<li><strong>模块化</strong>：<code>Fragment</code> 可以作为独立的模块，封装特定的功能和布局。这使得代码更加清晰，便于管理和维护。</li>
<li><strong>复用性</strong>：同一个 <code>Fragment</code> 可以在不同的 <code>Activity</code> 中复用，从而减少重复代码，提高开发效率。</li>
</ul>
<h4 id="2_1"><strong>（2）动态性与灵活性</strong></h4>
<ul>
<li><strong>动态加载</strong>：<code>Fragment</code> 可以在运行时动态添加、移除或替换，这使得界面更加灵活，可以根据用户的操作或应用的状态动态调整界面布局。</li>
<li><strong>生命周期管理</strong>：<code>Fragment</code> 有自己的生命周期，类似于 <code>Activity</code>，但更加灵活。开发者可以在 <code>Fragment</code> 的生命周期方法中进行资源的初始化和释放。</li>
</ul>
<h4 id="3_2"><strong>（3）多屏适配</strong></h4>
<ul>
<li><strong>多屏布局</strong>：<code>Fragment</code> 特别适合在平板电脑等大屏幕上实现多屏布局。通过在同一个 <code>Activity</code> 中使用多个 <code>Fragment</code>，可以创建复杂的界面布局，提升用户体验。</li>
<li><strong>响应式设计</strong>：<code>Fragment</code> 可以根据屏幕尺寸和方向动态调整布局，实现响应式设计。</li>
</ul>
<h4 id="4activity"><strong>（4）与Activity的协作</strong></h4>
<ul>
<li><strong>通信机制</strong>：<code>Fragment</code> 可以通过接口回调的方式与 <code>Activity</code> 通信，实现数据共享和事件传递。</li>
<li><strong>生命周期关联</strong>：<code>Fragment</code> 的生命周期与 <code>Activity</code> 的生命周期密切相关，但 <code>Fragment</code> 可以独立于 <code>Activity</code> 进行操作。</li>
</ul>
<h4 id="5"><strong>（5）状态保存与恢复</strong></h4>
<ul>
<li><strong>保存状态</strong>：<code>Fragment</code> 提供了 <code>onSaveInstanceState</code> 方法，用于在配置变化（如屏幕旋转）时保存状态。</li>
<li><strong>恢复状态</strong>：在 <code>onCreate</code> 或 <code>onViewCreated</code> 方法中，可以通过 <code>savedInstanceState</code> 恢复保存的状态。</li>
</ul>
<h4 id="6fragment"><strong>（6）嵌套Fragment</strong></h4>
<ul>
<li><strong>嵌套支持</strong>：从 Android 4.2 开始，支持嵌套 <code>Fragment</code>，即一个 <code>Fragment</code> 可以包含另一个 <code>Fragment</code>。这使得界面布局更加灵活，但也需要谨慎使用以避免复杂性和潜在问题。</li>
<li><strong>管理嵌套</strong>：嵌套 <code>Fragment</code> 的生命周期管理更加复杂，需要确保正确管理每个 <code>Fragment</code> 的生命周期。</li>
</ul>
<h3 id="363-fragment">3.6.3 Fragment的使用</h3>
<p><strong>（1）创建Fragment</strong></p>
<p>创建一个 <code>Fragment</code> 需要继承 <code>androidx.fragment.app.Fragment</code> 类，并实现必要的生命周期方法。例如：</p>
<pre><code class="language-java">public class MyFragment extends Fragment {
    @Nullable
    @Override
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        // 加载布局文件
        return inflater.inflate(R.layout.fragment_my, container, false);
    }

    @Override
    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
        super.onViewCreated(view, savedInstanceState);
        // 初始化视图组件
        TextView textView = view.findViewById(R.id.tv_fragment);
        textView.setText(&quot;这是一个Fragment&quot;);
    }
}
</code></pre>
<p><strong>（2）在Activity中添加Fragment</strong></p>
<p>可以通过静态方式（在布局文件中定义）或动态方式（通过代码添加）将 <code>Fragment</code> 添加到 <code>Activity</code> 中。</p>
<p><strong>静态方式</strong>： 在布局文件中使用 <code>&lt;fragment&gt;</code> 标签：</p>
<pre><code class="language-xml">&lt;fragment
    android:id=&quot;@+id/my_fragment&quot;
    android:name=&quot;com.example.MyFragment&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot; /&gt;
</code></pre>
<p><strong>动态方式</strong>： 通过 <code>FragmentManager</code> 和 <code>FragmentTransaction</code> 动态添加 <code>Fragment</code>：</p>
<pre><code class="language-java">Fragment myFragment = new MyFragment();
FragmentManager fragmentManager = getSupportFragmentManager();
FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();
fragmentTransaction.add(R.id.fragment_container, myFragment);
fragmentTransaction.commit();
</code></pre>
<p><strong>（3）与Activity通信</strong></p>
<p><code>Fragment</code> 和 <code>Activity</code> 之间可以通过接口进行通信。例如：</p>
<pre><code class="language-java">public class MyFragment extends Fragment {
    private OnFragmentInteractionListener mListener;

    public interface OnFragmentInteractionListener {
        void onFragmentInteraction(String data);
    }

    @Override
    public void onAttach(Context context) {
        super.onAttach(context);
        if (context instanceof OnFragmentInteractionListener) {
            mListener = (OnFragmentInteractionListener) context;
        } else {
            throw new RuntimeException(context.toString() + &quot; must implement OnFragmentInteractionListener&quot;);
        }
    }

    @Override
    public void onDetach() {
        super.onDetach();
        mListener = null;
    }

    public void someMethod() {
        if (mListener != null) {
            mListener.onFragmentInteraction(&quot;Hello from Fragment&quot;);
        }
    }
}
</code></pre>
<p>在 <code>Activity</code> 中实现接口：</p>
<pre><code class="language-java">public class MyActivity extends AppCompatActivity implements MyFragment.OnFragmentInteractionListener {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_my);
    }

    @Override
    public void onFragmentInteraction(String data) {
        // 处理来自Fragment的数据
        Toast.makeText(this, data, Toast.LENGTH_SHORT).show();
    }
}
</code></pre>
<h2 id="37-tabnavigation">3.7 Tab和Navigation</h2>
<p><strong>Tab和Navigation是现代Android应用中常见的导航方式。掌握Tab和Navigation是提升应用交互性的关键</strong>。</p>
<p>本章将介绍如何使用TabLayout、ViewPager和Navigation组件实现流畅的导航体验，以及如何通过这些组件优化应用的结构和用户体验。同时Tab通常是与Fragment结合，我们这里也通过Tab的方式，展示Fragment的用法。</p>
<h3 id="371-tab">3.7.1 Tab的介绍与使用</h3>
<p>Tab（标签）界面如下图所示：</p>
<p><img alt="3-9" src="../fig03/3-9.png" /></p>
<!-- 图3-9 Tab例子 -->

<p>TabLayout 是安卓提供的一个组件，用于创建标签导航。通过与 ViewPager 配合使用，TabLayout 可以轻松实现可滑动的标签视图。TabLayout中的每个Tab都是一个Fragment，通过滑动Tab动态切换Fragment。</p>
<p>使用 TabLayout 一般包含以下几个步骤：（1）添加依赖：在项目的 build.gradle 文件中添加对 Material Components 的依赖，如下所示：</p>
<pre><code class="language-xml">implementation 'com.google.android.material:material:1.4.0'
</code></pre>
<p>（2）布局文件：在布局文件中添加TabLayout和ViewPager：</p>
<pre><code class="language-xml">&lt;com.google.android.material.tabs.TabLayout  
    android:id=&quot;@+id/tab_layout&quot;  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;wrap_content&quot; /&gt;  

&lt;androidx.viewpager.widget.ViewPager  
    android:id=&quot;@+id/view_pager&quot;  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;match_parent&quot; /&gt;  
</code></pre>
<p>（3）Activity文件：在Activity中设置TabLayout和ViewPager：</p>
<pre><code class="language-java">public class MainActivity extends AppCompatActivity {  

    @Override  
    protected void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.activity_main);  

        TabLayout tabLayout = findViewById(R.id.tab_layout);  
        ViewPager viewPager = findViewById(R.id.view_pager);  

        // 设置ViewPager的适配器  
        viewPager.setAdapter(new ViewPagerAdapter(getSupportFragmentManager()));  

        // 将TabLayout与ViewPager关联  
        tabLayout.setupWithViewPager(viewPager);  
    }  

    // ViewPager适配器  
    private class ViewPagerAdapter extends FragmentPagerAdapter {  

        public ViewPagerAdapter(@NonNull FragmentManager fm) {  
            super(fm);  
        }  

        @NonNull  
        @Override  
        public Fragment getItem(int position) {  
            switch (position) {  
                case 0:  
                    return new FragmentOne();  
                case 1:  
                    return new FragmentTwo();  
                case 2:  
                    return new FragmentThree();  
                default:  
                    return null;  
            }  
        }  

        @Override  
        public int getCount() {  
            return 3; // 返回Tab的数量  
        }  

        @Nullable  
        @Override  
        public CharSequence getPageTitle(int position) {  
            switch (position) {  
                case 0:  
                    return &quot;Tab One&quot;;  
                case 1:  
                    return &quot;Tab Two&quot;;  
                case 2:  
                    return &quot;Tab Three&quot;;  
                default:  
                    return null;  
            }  
        }  
    }  
}  

</code></pre>
<p>TabLayout 提供了多种属性来定制其外观和行为，例如：
-   app:tabMode：设置标签的显示模式。常见值有 fixed 和 scrollable。
-   app:tabGravity：设置标签的对齐方式。常见值有 fill 和 center。
-   app:tabIndicatorColor：设置标签指示器的颜色。
-   app:tabSelectedTextColor：设置选中标签的文字颜色。
-   app:tabTextColor：设置未选中标签的文字颜色。</p>
<p>这些属性可以在XML布局文件中进行设置：</p>
<pre><code class="language-xml">&lt;com.google.android.material.tabs.TabLayout  
    android:id=&quot;@+id/tab_layout&quot;  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;wrap_content&quot;  
    app:tabMode=&quot;fixed&quot;  
    app:tabGravity=&quot;fill&quot;  
    app:tabIndicatorColor=&quot;@color/colorAccent&quot;  
    app:tabSelectedTextColor=&quot;@color/colorPrimary&quot;  
    app:tabTextColor=&quot;@android:color/darker_gray&quot; /&gt;  
</code></pre>
<h3 id="372-navigation">3.7.2 Navigation的介绍和使用</h3>
<p>在Android应用开发中，底部导航栏（Bottom Navigation Bar）是一种常用的导航模式。BottomNavigationView 是 Android 提供的一个组件，用于在屏幕底部创建一个导航栏，以方便用户在不同的视图之间进行切换，如下图所示</p>
<p><img alt="navigation" src="../fig03/navigation.PNG" /></p>
<p>BottomNavigationView 是 Material Design 组件库中的一个视图组件，用于实现底部导航栏。它通常包含三个到五个导航项，每个项对应一个不同的视图或Fragment。通过与 Fragment 的结合，可以轻松创建用户友好的导航体验。</p>
<p>使用 BottomNavigationView 一般包含以下几个步骤：</p>
<p>（1）添加依赖：在项目的 build.gradle 文件中添加对 Material Components 的依赖，如下所示</p>
<pre><code class="language-java">implementation 'com.google.android.material:material:1.4.0'
</code></pre>
<p>（2）布局文件：在布局文件中添加TabLayout和ViewPager：</p>
<pre><code class="language-xml">&lt;com.google.android.material.bottomnavigation.BottomNavigationView  
    android:id=&quot;@+id/bottom_navigation&quot;  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;wrap_content&quot;  
    android:layout_alignParentBottom=&quot;true&quot;  
    app:menu=&quot;@menu/bottom_nav_menu&quot; /&gt;  
</code></pre>
<p>（3）资源文件：在 res/menu 目录下创建 bottom_nav_menu.xml 文件，定义导航项：</p>
<pre><code class="language-xml">&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;  
    &lt;item  
        android:id=&quot;@+id/nav_home&quot;  
        android:icon=&quot;@drawable/ic_home&quot;  
        android:title=&quot;Home&quot; /&gt;  
    &lt;item  
        android:id=&quot;@+id/nav_search&quot;  
        android:icon=&quot;@drawable/ic_search&quot;  
        android:title=&quot;Search&quot; /&gt;  
    &lt;item  
        android:id=&quot;@+id/nav_profile&quot;  
        android:icon=&quot;@drawable/ic_profile&quot;  
        android:title=&quot;Profile&quot; /&gt;  
&lt;/menu&gt;  
</code></pre>
<p>（4）Activity文件：Java在Activity中设置BottomNavigationView：</p>
<pre><code class="language-java">public class MainActivity extends AppCompatActivity {  

    @Override  
    protected void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.activity_main);  

        BottomNavigationView bottomNavigationView = findViewById(R.id.bottom_navigation);  

        // 设置导航项选择监听器  
        bottomNavigationView.setOnNavigationItemSelectedListener(new BottomNavigationView.OnNavigationItemSelectedListener() {  
            @Override  
            public boolean onNavigationItemSelected(@NonNull MenuItem item) {  
                Fragment selectedFragment = null;  
                switch (item.getItemId()) {  
                    case R.id.nav_home:  
                        selectedFragment = new HomeFragment();  
                        break;  
                    case R.id.nav_search:  
                        selectedFragment = new SearchFragment();  
                        break;  
                    case R.id.nav_profile:  
                        selectedFragment = new ProfileFragment();  
                        break;  
                }  
                // 切换Fragment  
                getSupportFragmentManager().beginTransaction().replace(R.id.Fragment_container, selectedFragment).commit();  
                return true;  
            }  
        });  

        // 默认选择的导航项  
        bottomNavigationView.setSelectedItemId(R.id.nav_home);  
    }  
} 
</code></pre>
<p>BottomNavigationView 提供了多种属性来定制其外观和行为：</p>
<ul>
<li>app:menu：设置导航栏的菜单资源文件。</li>
<li>app:itemIconTint：设置导航项图标的颜色。</li>
<li>app:itemTextColor：设置导航项文字的颜色。</li>
<li>app:labelVisibilityMode：设置标签的显示模式，常见值有 labeled（始终显示标签）和 unlabeled（仅显示图标）。</li>
</ul>
<p>这些属性可以在XML布局文件中进行设置：</p>
<pre><code class="language-xml">&lt;com.google.android.material.bottomnavigation.BottomNavigationView  
android:id=&quot;@+id/bottom_navigation&quot;  
android:layout_width=&quot;match_parent&quot;  
android:layout_height=&quot;wrap_content&quot;  
android:layout_alignParentBottom=&quot;true&quot;  
app:menu=&quot;@menu/bottom_nav_menu&quot;  
app:itemIconTint=&quot;@color/nav_item_color&quot;  
app:itemTextColor=&quot;@color/nav_item_color&quot;  
app:labelVisibilityMode=&quot;labeled&quot; /&gt; 
</code></pre>
<p>通过综合使用TabView和BottomNavigation，可以设计出复杂的应用导航方式，同时兼顾用户体验。现在大量的应用几乎都是采用这种方式来组织界面。</p>
<h3 id="373-tab">3.7.3 大模型实现Tab的示例</h3>
<p>下面我们也再来看看如何使用大模型来帮助我们实现Tab相关的布局效果。</p>
<p><strong>交互过程1：目标输入</strong></p>
<p><strong>用户：</strong></p>
<p>请帮我写一个示例，如何在安卓中使用Java编写Tab页面？</p>
<p><strong>大模型：</strong></p>
<p>在Android开发中，可以使用<code>TabLayout</code>和<code>ViewPager</code>来实现带有标签页（Tab）的界面。以下是一个完整的示例，展示如何使用Java在Android中实现一个带有多个Tab页的界面。</p>
<p><strong>示例：实现一个带有三个Tab页的Android应用</strong></p>
<p>1.添加依赖</p>
<p>在<code>build.gradle</code>文件中添加<code>TabLayout</code>和<code>ViewPager</code>的依赖（如果使用的是Material Design组件）：</p>
<pre><code class="language-gradle">dependencies {
    implementation 'androidx.viewpager:viewpager:1.0.0'
    implementation 'com.google.android.material:material:1.9.0'
}
</code></pre>
<p>2.布局文件</p>
<p>创建一个布局文件<code>activity_main.xml</code>，用于定义<code>TabLayout</code>和<code>ViewPager</code>：</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:orientation=&quot;vertical&quot;&gt;

    &lt;com.google.android.material.tabs.TabLayout
        android:id=&quot;@+id/tabLayout&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        app:tabGravity=&quot;fill&quot;
        app:tabMode=&quot;fixed&quot; /&gt;

    &lt;androidx.viewpager.widget.ViewPager
        android:id=&quot;@+id/viewPager&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;0dp&quot;
        android:layout_weight=&quot;1&quot; /&gt;
&lt;/LinearLayout&gt;
</code></pre>
<p>3.创建Fragment</p>
<p>为每个Tab创建一个<code>Fragment</code>。以下是一个简单的<code>Fragment</code>示例：</p>
<pre><code class="language-java">// TabFragment.java
package com.example.tabexample;

import android.os.Bundle;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.fragment.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.TextView;

public class TabFragment extends Fragment {
    private String tabTitle;

    public static TabFragment newInstance(String title) {
        TabFragment fragment = new TabFragment();
        Bundle args = new Bundle();
        args.putString(&quot;title&quot;, title);
        fragment.setArguments(args);
        return fragment;
    }

    @Override
    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (getArguments() != null) {
            tabTitle = getArguments().getString(&quot;title&quot;);
        }
    }

    @Nullable
    @Override
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.fragment_tab, container, false);
        TextView textView = view.findViewById(R.id.tabText);
        textView.setText(tabTitle);
        return view;
    }
}
</code></pre>
<p>创建<code>fragment_tab.xml</code>布局文件：</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:orientation=&quot;vertical&quot;
    android:gravity=&quot;center&quot;&gt;

    &lt;TextView
        android:id=&quot;@+id/tabText&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:textSize=&quot;24sp&quot;
        android:textStyle=&quot;bold&quot; /&gt;
&lt;/LinearLayout&gt;
</code></pre>
<p>4.创建适配器</p>
<p>创建一个<code>FragmentPagerAdapter</code>来管理<code>ViewPager</code>中的<code>Fragment</code>：</p>
<pre><code class="language-java">// ViewPagerAdapter.java
package com.example.tabexample;

import androidx.annotation.NonNull;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentPagerAdapter;

public class ViewPagerAdapter extends FragmentPagerAdapter {
    private String[] tabTitles;

    public ViewPagerAdapter(@NonNull FragmentManager fm, String[] tabTitles) {
        super(fm, BEHAVIOR_RESUME_ONLY_CURRENT_FRAGMENT);
        this.tabTitles = tabTitles;
    }

    @NonNull
    @Override
    public Fragment getItem(int position) {
        return TabFragment.newInstance(tabTitles[position]);
    }

    @Override
    public int getCount() {
        return tabTitles.length;
    }

    @Override
    public CharSequence getPageTitle(int position) {
        return tabTitles[position];
    }
}
</code></pre>
<p>5.主Activity</p>
<p>在<code>MainActivity</code>中设置<code>TabLayout</code>和<code>ViewPager</code>：</p>
<pre><code class="language-java">// MainActivity.java
package com.example.tabexample;

import android.os.Bundle;
import androidx.appcompat.app.AppCompatActivity;
import androidx.viewpager.widget.ViewPager;
import com.google.android.material.tabs.TabLayout;

public class MainActivity extends AppCompatActivity {
    private TabLayout tabLayout;
    private ViewPager viewPager;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        tabLayout = findViewById(R.id.tabLayout);
        viewPager = findViewById(R.id.viewPager);

        String[] tabTitles = {&quot;Tab 1&quot;, &quot;Tab 2&quot;, &quot;Tab 3&quot;};
        ViewPagerAdapter adapter = new ViewPagerAdapter(getSupportFragmentManager(), tabTitles);
        viewPager.setAdapter(adapter);

        tabLayout.setupWithViewPager(viewPager);
    }
}
</code></pre>
<p>6.运行效果</p>
<p>运行应用后，你将看到一个带有三个Tab页的界面，每个Tab页显示对应的标题。</p>
<p><strong>说明</strong></p>
<ul>
<li><code>TabLayout</code>用于显示Tab标题。</li>
<li><code>ViewPager</code>用于显示内容页面。</li>
<li><code>ViewPagerAdapter</code>用于管理<code>ViewPager</code>中的<code>Fragment</code>。</li>
<li>每个<code>Fragment</code>显示一个简单的<code>TextView</code>，显示Tab的标题。</li>
</ul>
<p>你可以根据需要扩展<code>Fragment</code>的内容，添加更复杂的布局和逻辑。</p>
<hr />
<p><strong>操作：</strong></p>
<p>根据大模型的输出，我们将依次进行以下操作：</p>
<ul>
<li>添加依赖到<code>build.gradle</code>里</li>
<li>将XML代码复制到<code>activity_main.xml</code>里面，定义<code>TabLayout</code>和<code>ViewPager</code></li>
<li>创建类<code>TabFragment</code>，将代码复制到相应文件里，这里面Fragment是每一个Tab里面展示的内容，用户可以根据自己的布局进行修改。</li>
<li>创建布局文件<code>fragment_tab.xml</code>，将代码复制到相应文件里，这里我们3个Tab都使用的是同一个Fragment布局，也可以换成不同的<code>Fragment</code>布局。</li>
<li>创建适配器类<code>ViewPagerAdapter</code>，将代码复制到相应文件里，这个Adapter是重要的部分，就是用来管理Tab里面的不同页面，读者可以仔细去看一下Adapter里面的写法，很多不同的应用都需要用到Adapter。</li>
<li>修改<code>MainActivity</code>，设置<code>TabLayout</code>和<code>ViewPager</code></li>
</ul>
<p>（3）运行示例</p>
<p>打开应用，首先看到<code>Tab1</code>：</p>
<p><img alt="" src="../fig03/tab_1.png" /></p>
<p>点击后可以滑动到其他Tab，例如<code>Tab3</code>，每一个Tab里面展示的是非常简单的文字，这个在<code>fragment_tab.xml</code>中进行了定义：</p>
<p><img alt="" src="../fig03/tab_3.png" /></p>
<h3 id="374">3.7.4 大模型实现底部导航栏的示例</h3>
<p>同时，我们也展示一下，如何通过与大模型进行交互，实现底部导航栏的效果。</p>
<p><strong>交互过程1：目标输入</strong></p>
<p><strong>用户：</strong></p>
<p>实现<code>bottomNavigation</code>使用Android studio和Java</p>
<hr />
<p><strong>大模型：</strong></p>
<p>在Android Studio中使用Java实现底部导航栏（Bottom Navigation）的功能，你可以按照以下步骤进行：</p>
<p>创建新的Activity:</p>
<p>在Android Studio中，右键点击你的包名 -&gt; New -&gt; Activity -&gt; Bottom Navigation Activity。
这将为你创建一个新的Activity，其中已经包含了底部导航栏的基本代码。
理解代码结构:</p>
<p>底部导航栏通常由3-5个图标组成，每个图标代表一个Fragment。
在activity_main.xml中，你会看到一个BottomNavigationView控件。
在MainActivity.java中，你会看到与每个底部导航项关联的Fragments以及它们的切换逻辑。
自定义Fragment:</p>
<p>如果默认生成的Fragments不符合你的需求，你可以自定义它们。
在layout文件夹中为每个Fragment创建一个新的XML布局文件。
在java文件夹中为每个Fragment创建一个新的Java类，并继承Fragment。
更新MainActivity.java:</p>
<p>在MainActivity.java中，你会看到onNavigationItemSelected方法，这是当用户点击底部导航项时调用的方法。
在这个方法中，你可以添加或修改逻辑来切换Fragments。
例如，你可以使用getSupportFragmentManager().beginTransaction().replace(R.id.fragment_container, new YourFragment()).commit();来替换当前的Fragment。
更新activity_main.xml:</p>
<p>你可以根据需要修改activity_main.xml中的布局。
例如，你可以更改BottomNavigationView的ID或添加其他视图控件。
运行和测试:</p>
<p>点击运行按钮，在模拟器或连接的设备上测试你的应用。
确保底部导航栏正常工作，并且每个导航项都能正确显示相应的Fragment。
添加更多功能:</p>
<p>你可以为每个Fragment添加更多的功能，如列表、按钮、图片等。
你也可以添加更多的事件监听器来处理用户交互。
这就是使用Android Studio和Java实现底部导航栏的基本步骤。你可以根据自己的需求进行自定义和扩展。</p>
<hr />
<p><strong>操作</strong>
1. 使用Android studio：右键点击你的包名 -&gt; New -&gt; Activity -&gt; Bottom Navigation Activity即可生成具有bottom navigation的新建项目。
2. 查看该项目中相关代码文件，即可了解bottom navigation生成原理。</p>
<hr />
<p>但是大模型给出的都是原理性的话，并没有给出具体代码，我们可以将问题问得更加具体。</p>
<p><strong>交互过程2：案例</strong></p>
<p><strong>用户：</strong>
你能给我写个例子吗</p>
<hr />
<p><strong>大模型：</strong>
当然可以。下面是一个简单的例子，展示如何使用Android Studio和Java创建一个带有底部导航栏（BottomNavigationView）的应用。</p>
<p>第一步：创建新的BottomNavigationActivity
在Android Studio中，创建一个新的BottomNavigationActivity。这通常会自动生成一个带有三个Fragment的底部导航栏示例。</p>
<p>第二步：更新activity_main.xml
在activity_main.xml中，你会看到一个FrameLayout作为Fragment的容器和一个BottomNavigationView。确保BottomNavigationView的menu属性指向了一个菜单资源文件，比如navigation。</p>
<pre><code class="language-xml">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;  
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;  
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;match_parent&quot;  
    tools:context=&quot;.MainActivity&quot;&gt;  

    &lt;FrameLayout  
        android:id=&quot;@+id/fragment_container&quot;  
        android:layout_width=&quot;match_parent&quot;  
        android:layout_height=&quot;match_parent&quot;  
        android:layout_above=&quot;@id/nav_view&quot; /&gt;  

    &lt;com.google.android.material.bottomnavigation.BottomNavigationView  
        android:id=&quot;@+id/nav_view&quot;  
        android:layout_width=&quot;match_parent&quot;  
        android:layout_height=&quot;wrap_content&quot;  
        android:layout_alignParentBottom=&quot;true&quot;  
        app:menu=&quot;@menu/bottom_nav_menu&quot; /&gt;  

&lt;/RelativeLayout&gt;
</code></pre>
<p>注意：在这个例子中，我使用了RelativeLayout，但ConstraintLayout可能是一个更好的选择，因为它更灵活且性能更佳。</p>
<p>第三步：创建菜单资源文件
在res/menu目录下创建一个名为bottom_nav_menu.xml的文件，并添加你的导航项。</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  
&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;  
    &lt;item  
        android:id=&quot;@+id/navigation_home&quot;  
        android:icon=&quot;@drawable/ic_home&quot;  
        android:title=&quot;@string/title_home&quot; /&gt;  
    &lt;item  
        android:id=&quot;@+id/navigation_dashboard&quot;  
        android:icon=&quot;@drawable/ic_dashboard&quot;  
        android:title=&quot;@string/title_dashboard&quot; /&gt;  
    &lt;item  
        android:id=&quot;@+id/navigation_notifications&quot;  
        android:icon=&quot;@drawable/ic_notifications&quot;  
        android:title=&quot;@string/title_notifications&quot; /&gt;  
&lt;/menu&gt;
</code></pre>
<p>确保你有相应的图标资源放在res/drawable目录下。</p>
<p>第四步：更新MainActivity.java
在MainActivity.java中，你需要处理底部导航栏的点击事件，并切换相应的Fragment。</p>
<pre><code class="language-java">public class MainActivity extends AppCompatActivity {  

    private BottomNavigationView.OnNavigationItemSelectedListener mOnNavigationItemSelectedListener  
            = new BottomNavigationView.OnNavigationItemSelectedListener() {  

        @Override  
        public boolean onNavigationItemSelected(@NonNull MenuItem item) {  
            Fragment fragment = null;  
            switch (item.getItemId()) {  
                case R.id.navigation_home:  
                    fragment = new HomeFragment();  
                    loadFragment(fragment);  
                    return true;  
                case R.id.navigation_dashboard:  
                    fragment = new DashboardFragment();  
                    loadFragment(fragment);  
                    return true;  
                case R.id.navigation_notifications:  
                    fragment = new NotificationsFragment();  
                    loadFragment(fragment);  
                    return true;  
            }  
            return false;  
        }  
    };  

    @Override  
    protected void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.activity_main);  

        BottomNavigationView navView = findViewById(R.id.nav_view);  
        navView.setOnNavigationItemSelectedListener(mOnNavigationItemSelectedListener);  

        // 默认加载第一个Fragment  
        loadFragment(new HomeFragment());  
    }  

    private void loadFragment(Fragment fragment) {  
        // 替换FrameLayout中的Fragment  
        FragmentTransaction transaction = getSupportFragmentManager().beginTransaction();  
        transaction.replace(R.id.fragment_container, fragment);  
        transaction.commit();  
    }  
}
</code></pre>
<p>确保你已经创建了HomeFragment、DashboardFragment和NotificationsFragment这三个Fragment类，以及它们的对应布局文件。</p>
<p>第五步：运行应用
现在你可以运行应用了。点击Android Studio的运行按钮，选择一个模拟器或连接的真实设备，然后观察底部导航栏是否正常工作，以及点击不同的导航项时是否能够切换到对应的Fragment。</p>
<hr />
<p><strong>操作：</strong>
我们按照大模型推荐的步骤操作就行，不过这里面很有意思的一点是，在第二步中，大模型表示使用ConstraintLayout更好，由于Android studio自动生成的activity即为ConstraintLayout，
在第三步中，大模型内容与自动生成内容一致，不做修改，值得注意的是：
“<code>android:title="@string/title_notifications</code>”，需要保证在<code>res/values/strings.xml</code>文件中有</p>
<pre><code class="language-xml">    &lt;string name=&quot;title_home&quot;&gt;Home&lt;/string&gt;
    &lt;string name=&quot;title_dashboard&quot;&gt;Dashboard&lt;/string&gt;
    &lt;string name=&quot;title_notifications&quot;&gt;Notifications&lt;/string&gt;
</code></pre>
<p>第四步内容与自动生成内容不一致，将大模型内容复制粘贴至mainActivity.java。结果：可以实现导航栏切换，但是HomeFragment的内容一直处于页面中，会产生页面混叠的现象，如下图所示</p>
<p><img alt="home" src="../fig03/bottomNavigation_home.png" /></p>
<p><img alt="dashboard" src="../fig03/bottomNavigation_dashboard.png" /></p>
<p><img alt="notifications" src="../fig03/bottomNavigation_notifications.png" /></p>
<p>但是使用Android studio自己生成的代码并不会出现以下问题，考虑是否可能是因为第二步采用的是constraintLayout，而不是大模型提供的RelativeLayout，故对<code>activity_main.xml</code>进行修改，修改后可以正常运行，不会出现混叠现象，即相应的导航栏只会出现其中一条对应的"This is xxx fragment"字样。
因此需要注意不同的Layout具有不同的性能，要进行合适的搭配；以及要相信大模型给出的搭配。此时可以向大模型询问为什么不同的layout会出现不一样的结果。</p>
<hr />
<p><strong>交互过程3：异样查询</strong></p>
<p><strong>用户：</strong></p>
<p>在上述内容中，为什么将relativeLayout改成Constraintlayout会出现，多个fragment混叠的现象</p>
<p><strong>大模型：</strong></p>
<p>在上述内容中，将 RelativeLayout 改为 ConstraintLayout 后出现多个 Fragment 混叠的现象，主要是因为 ConstraintLayout 的布局约束方式与 RelativeLayout 不同，如果没有正确设置约束，可能会导致布局问题。</p>
<p>1.RelativeLayout 和 ConstraintLayout 的区别</p>
<p>RelativeLayout：</p>
<p>子视图的位置是通过与其他视图或父视图的相对位置来定义的。</p>
<p>在你的代码中，FrameLayout 被设置为在 BottomNavigationView 的上方（android:layout_above="@id/nav_view"），因此它会自动占据除底部导航栏之外的区域。</p>
<p>ConstraintLayout：</p>
<p>子视图的位置是通过约束（Constraints）来定义的，需要明确指定每个视图的起点和终点。</p>
<p>如果没有正确设置约束，子视图可能会重叠或布局不正确。</p>
<p>2.为什么会出现 Fragment 混叠</p>
<p>在 ConstraintLayout 中，如果没有正确设置 FrameLayout 和 BottomNavigationView 的约束，可能会导致以下问题：</p>
<p>FrameLayout 的高度没有被正确约束：在 RelativeLayout 中，FrameLayout 的高度是通过 android:layout_above 属性自动调整的。但在 ConstraintLayout 中，如果没有设置顶部和底部约束，FrameLayout 的高度可能会被设置为 match_parent，从而覆盖 BottomNavigationView。</p>
<p>BottomNavigationView 的位置没有被正确约束：如果没有设置 BottomNavigationView 的底部约束（如 app:layout_constraintBottom_toBottomOf="parent"），它可能会被放置在错误的位置，导致布局混乱。</p>
<p>3.如何解决</p>
<p>要解决这个问题，需要正确设置 ConstraintLayout 中的约束。以下是修改后的布局代码示例：</p>
<pre><code class="language-xml">&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    tools:context=&quot;.MainActivity&quot;&gt;

    &lt;FrameLayout
        android:id=&quot;@+id/fragment_container&quot;
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;0dp&quot;
        app:layout_constraintTop_toTopOf=&quot;parent&quot;
        app:layout_constraintBottom_toTopOf=&quot;@id/nav_view&quot;
        app:layout_constraintLeft_toLeftOf=&quot;parent&quot;
        app:layout_constraintRight_toRightOf=&quot;parent&quot; /&gt;

    &lt;com.google.android.material.bottomnavigation.BottomNavigationView
        android:id=&quot;@+id/nav_view&quot;
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;wrap_content&quot;
        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;
        app:layout_constraintLeft_toLeftOf=&quot;parent&quot;
        app:layout_constraintRight_toRightOf=&quot;parent&quot;
        app:menu=&quot;@menu/bottom_nav_menu&quot; /&gt;

&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;
</code></pre>
<p>4.关键点说明</p>
<p>FrameLayout 的约束：</p>
<p>app:layout_constraintTop_toTopOf="parent"：顶部与父视图对齐。</p>
<p>app:layout_constraintBottom_toTopOf="@id/nav_view"：底部与 BottomNavigationView 的顶部对齐。</p>
<p>app:layout_constraintLeft_toLeftOf="parent" 和 app:layout_constraintRight_toRightOf="parent"：左右两侧与父视图对齐。</p>
<p>宽度和高度设置为 0dp，表示宽度和高度由约束决定。</p>
<p>BottomNavigationView 的约束：</p>
<p>app:layout_constraintBottom_toBottomOf="parent"：底部与父视图对齐。</p>
<p>app:layout_constraintLeft_toLeftOf="parent" 和 app:layout_constraintRight_toRightOf="parent"：左右两侧与父视图对齐。</p>
<p>通过正确设置这些约束，可以确保 FrameLayout 和 BottomNavigationView 的布局正确，避免 Fragment 混叠的问题。</p>
<hr />
<p><strong>操作：</strong>
根据大模型提供的代码修改activity_main.xml，导航栏可以正常运行，不存在混叠现象。</p>
<hr />
<!-- 
**用户：**
constraintLayout和relativeLayout有什么区别

**大模型：**
ConstraintLayout和RelativeLayout都是Android开发中常用的布局方式，但它们在功能和性能上存在一些关键差异。

RelativeLayout是一种相对布局，控件的位置是按照相对位置来计算的。在这种布局中，控件之间的位置具有相对对应的关系，因此它被认为是一种非常灵活且常用的布局方式。然而，RelativeLayout的一个潜在问题是性能问题，特别是当布局复杂且嵌套层次较多时。这是因为RelativeLayout会对其每个子对象重复测量两次，这可能导致性能低下。

相比之下，ConstraintLayout是一种约束布局，控件之间以及控件与父布局之间具有约束关系。控件的位置是按照这些约束来计算的。ConstraintLayout的一个主要优点是它可以在不嵌套任何布局的情况下构建复杂的布局，这使得它比RelativeLayout更加灵活且性能更优。此外，ConstraintLayout还允许添加引导线（Guideline）来辅助布局，所有的布局可以在界面上通过拖动和调整来完成，这使得布局调整更为方便，实现了所见即所得的效果。

总的来说，ConstraintLayout在性能和灵活性上相对于RelativeLayout有所优势，特别是在构建复杂布局时。然而，具体选择哪种布局方式还需要根据具体的应用场景和需求来决定。

[TODO:这里还没有解释清楚现象出现的原因] 
-->

<h2 id="38-recyclerview">3.8 RecyclerView</h2>
<p>RecyclerView是Android中用于高效显示大量数据的组件，是实现高性能数据展示的核心。
本章将详细介绍RecyclerView的基本用法、如何自定义适配器和布局管理器，以及如何实现数据的动态加载和更新。</p>
<h3 id="381-recyclerview">3.8.1 RecyclerView的组件</h3>
<p>RecyclerView的实现主要包括以下几个组件：</p>
<p>（1）Adapter：
是的，又是Adapter，相信大家已经不陌生了。Adapter是连接数据源和RecyclerView的桥梁。它负责从数据源获取数据并创建用于显示这些数据的ViewHolder。每个ViewHolder对应
一个单独的列表项视图。</p>
<p>常见的方法有：
-   onCreateViewHolder(ViewGroup parent, int viewType)：创建一个新的ViewHolder对象，这里面每一个ViewHolder可以认为就是列表里面的一行。
-   onBindViewHolder(VH holder, int position)：将数据绑定到指定位置的ViewHolder上
-   getItemCount()：返回数据集的总数，也就是要显示的数据总的行数。</p>
<p>（2）ViewHolder：
ViewHolder是一个用于缓存列表项视图的静态内部类。它减少了findViewById调用的次数。ViewHolder中通常包含了列表项视图中的子视图，可以直接操作子视图的组件。</p>
<p>（3）LayoutManager：
LayoutManager负责管理RecyclerView的所有项。它决定了RecyclerView的布局方式。
常见的LayoutManager：
-   LinearLayoutManager：用于创建垂直或水平滚动列表。
-   GridLayoutManager：用于创建网格布局。
-   StaggeredGridLayoutManager：用于创建瀑布流布局。</p>
<p>他们之间的关系可以用下图表示：</p>
<p><img alt="" src="../fig03/recycle_view.png" /></p>
<h3 id="382-recycleview">3.8.2 RecycleView的使用方式</h3>
<p>（1）添加依赖：
在项目的build.gradle文件中添加RecyclerView的依赖：</p>
<pre><code class="language-java">dependencies {
    implementation 'androidx.recyclerview:recyclerview:1.2.1'
}
</code></pre>
<p>（2）创建布局文件：
创建一个包含RecyclerView的布局文件：</p>
<pre><code class="language-xml">&lt;androidx.recyclerview.widget.RecyclerView  
    android:id=&quot;@+id/recyclerView&quot;  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;match_parent&quot;/&gt;
</code></pre>
<p>（3）创建适配器：
实现自定义的Adapter类：</p>
<pre><code class="language-java">public class MyAdapter extends RecyclerView.Adapter&lt;MyAdapter.MyViewHolder&gt; {  
    private List&lt;String&gt; dataList;  

    public MyAdapter(List&lt;String&gt; dataList) {  
        this.dataList = dataList;  
    }  

    @Override  
    public MyViewHolder onCreateViewHolder(ViewGroup parent, int viewType) {  
        View view = LayoutInflater.from(parent.getContext())  
                .inflate(R.layout.list_item, parent, false);  
        return new MyViewHolder(view);  
    }  

    @Override  
    public void onBindViewHolder(MyViewHolder holder, int position) {  
        String data = dataList.get(position);  
        holder.textView.setText(data);  
    }  

    @Override  
    public int getItemCount() {  
        return dataList.size();  
    }  

    public static class MyViewHolder extends RecyclerView.ViewHolder {  
        TextView textView;  

        public MyViewHolder(View itemView) {  
            super(itemView);  
            textView = itemView.findViewById(R.id.textView);  
        }  
    }  
}  
</code></pre>
<p>（4）设置RecyclerView</p>
<p>在Activity或Fragment中设置RecyclerView和Adapter：</p>
<pre><code class="language-java">RecyclerView recyclerView = findViewById(R.id.recyclerView);  
MyAdapter adapter = new MyAdapter(dataList);  
recyclerView.setAdapter(adapter);  
recyclerView.setLayoutManager(new LinearLayoutManager(this));  
</code></pre>
<h3 id="383-recyclerview">3.8.3 大模型在RecyclerView中的应用</h3>
<p>我们将要写一个简单的应用，实现以下功能：
-   上方有一个消息列表，显示所有收到的消息。
-   在界面的最下方有一个输入框，输入文字并点击“发送”按钮后，会在上面的消息列表中显示出来。
-   点击某条消息后边的删除按钮后，删除该条消息。
怎么界面布局模拟的就是很多消息发送界面的形式，使用的场景非常广泛。</p>
<p>我们首先创建一个空项目，选择Empty Views Activity，项目名称任意，其他保持默认。对于该APP，我们按照需要实现的功能点对过程进行解构。</p>
<p><strong>交互过程1：目标输入</strong></p>
<p><strong>用户：</strong>
我现在要实现一个可发送和删除的消息列表，首先请用RecycleView实现一个消息列表。</p>
<hr />
<p><strong>大模型：</strong></p>
<p>在Android中，可以使用RecyclerView来实现一个消息列表。以下是一个简单的实现示例，包括如何发送和删除消息。</p>
<p>步骤一：设置RecyclerView</p>
<p>1.添加依赖项：确保在你的<code>build.gradle</code>文件中添加了RecyclerView的依赖项。</p>
<pre><code class="language-java">dependencies {
    implementation 'androidx.recyclerview:recyclerview:1.2.1'
}
</code></pre>
<p>2.创建消息数据类：</p>
<pre><code class="language-java">public class Message {  
    private String content;  

    public Message(String content) {  
        this.content = content;  
    }  

    public String getContent() {  
        return content;  
    }  

    public void setContent(String content) {  
        this.content = content;  
    }  
}  
</code></pre>
<p>3.创建RecyclerView的布局文件（res/layout/activity_main.xml）：</p>
<pre><code class="language-xml">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;match_parent&quot;&gt;  

    &lt;androidx.recyclerview.widget.RecyclerView  
        android:id=&quot;@+id/recyclerView&quot;  
        android:layout_width=&quot;match_parent&quot;  
        android:layout_height=&quot;match_parent&quot;/&gt;  

    &lt;EditText  
        android:id=&quot;@+id/messageInput&quot;  
        android:layout_width=&quot;match_parent&quot;  
        android:layout_height=&quot;wrap_content&quot;  
        android:layout_alignParentBottom=&quot;true&quot;  
        android:hint=&quot;Type a message&quot;/&gt;  

    &lt;Button  
        android:id=&quot;@+id/sendButton&quot;  
        android:layout_width=&quot;wrap_content&quot;  
        android:layout_height=&quot;wrap_content&quot;  
        android:layout_alignParentBottom=&quot;true&quot;  
        android:layout_alignParentRight=&quot;true&quot;  
        android:text=&quot;Send&quot;/&gt;  

&lt;/RelativeLayout&gt;  
</code></pre>
<p>4.创建RecyclerView的单个项布局文件（res/layout/item_message.xml）：</p>
<pre><code class="language-xml">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;wrap_content&quot;  
    android:orientation=&quot;horizontal&quot;  
    android:padding=&quot;10dp&quot;&gt;  

    &lt;TextView  
        android:id=&quot;@+id/messageContent&quot;  
        android:layout_width=&quot;0dp&quot;  
        android:layout_height=&quot;wrap_content&quot;  
        android:layout_weight=&quot;1&quot;/&gt;  

    &lt;Button  
        android:id=&quot;@+id/deleteButton&quot;  
        android:layout_width=&quot;wrap_content&quot;  
        android:layout_height=&quot;wrap_content&quot;  
        android:text=&quot;Delete&quot;/&gt;  

&lt;/LinearLayout&gt; 
</code></pre>
<p>5.创建RecyclerView的适配器：</p>
<pre><code class="language-java">public class MessageAdapter extends RecyclerView.Adapter&lt;MessageAdapter.MessageViewHolder&gt; {  
    private List&lt;Message&gt; messageList;  
    private OnDeleteClickListener onDeleteClickListener;  

    public MessageAdapter(List&lt;Message&gt; messageList, OnDeleteClickListener onDeleteClickListener) {  
        this.messageList = messageList;  
        this.onDeleteClickListener = onDeleteClickListener;  
    }  

    @NonNull  
    @Override  
    public MessageViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {  
        View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.item_message, parent, false);  
        return new MessageViewHolder(view);  
    }  

    @Override  
    public void onBindViewHolder(@NonNull MessageViewHolder holder, int position) {  
        Message message = messageList.get(position);  
        holder.messageContent.setText(message.getContent());  
        holder.deleteButton.setOnClickListener(v -&gt; onDeleteClickListener.onDeleteClick(position));  
    }  

    @Override  
    public int getItemCount() {  
        return messageList.size();  
    }  

    static class MessageViewHolder extends RecyclerView.ViewHolder {  
        TextView messageContent;  
        Button deleteButton;  

        public MessageViewHolder(@NonNull View itemView) {  
            super(itemView);  
            messageContent = itemView.findViewById(R.id.messageContent);  
            deleteButton = itemView.findViewById(R.id.deleteButton);  
        }  
    }  

    public interface OnDeleteClickListener {  
        void onDeleteClick(int position);  
    }  
} 
</code></pre>
<p>6.在活动中设置RecyclerView和适配器（MainActivity.java）：</p>
<pre><code class="language-java">public class MainActivity extends AppCompatActivity {  
    private RecyclerView recyclerView;  
    private MessageAdapter messageAdapter;  
    private List&lt;Message&gt; messageList;  
    private EditText messageInput;  
    private Button sendButton;  

    @Override  
    protected void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.activity_main);  

        recyclerView = findViewById(R.id.recyclerView);  
        messageInput = findViewById(R.id.messageInput);  
        sendButton = findViewById(R.id.sendButton);  

        messageList = new ArrayList&lt;&gt;();  
        messageAdapter = new MessageAdapter(messageList, position -&gt; {  
            messageList.remove(position);  
            messageAdapter.notifyItemRemoved(position);  
        });  

        recyclerView.setLayoutManager(new LinearLayoutManager(this));  
        recyclerView.setAdapter(messageAdapter);  

        sendButton.setOnClickListener(v -&gt; {  
            String content = messageInput.getText().toString();  
            if (!content.isEmpty()) {  
                messageList.add(new Message(content));  
                messageAdapter.notifyItemInserted(messageList.size() - 1);  
                messageInput.setText(&quot;&quot;);  
            }  
        });  
    }  
}  
</code></pre>
<p>通过以上步骤，你就可以实现一个可以发送和删除消息的RecyclerView列表了。</p>
<hr />
<p><strong>操作：</strong></p>
<p>我们根据对话内容依次进行以下操作：</p>
<ul>
<li>在build.gradle文件中添加RecyclerView的依赖项</li>
<li>新建一个Message类并填入相应内容（注意保留创建文件时自带的第一行包名）</li>
<li>将RecycleView组件添加进activity_main.xml文件中</li>
<li>新建一个item_message.xml文件来创建RecycleView中每一条消息的组件和布局</li>
<li>新建一个MessageAdapter类并填入相应内容（注意保留创建文件时自带的第一行包名），以创建RecyclerView的适配器</li>
<li>在MainActivity.java文件中填入相应内容来将适配器应用在RecycleView上，并设置相关按钮的监听器</li>
</ul>
<p>编译运行，可以得到一个带有发送和删除功能的消息列表。虽然我们只想让大模型实现第一个功能点，但大模型聪明地直接给出了整个示例，最终结果如下图所示：</p>
<!-- 
[TODO:图片没有列表的效果]
[ANS:已添加]
-->

<p><img alt="3-10" src="../fig03/3-10.png" /></p>
<!-- 图3-10 消息列表示例 -->

<p>添加几个消息之后，列表效果如下图所示：</p>
<p><img alt="" src="../fig03/recycle_view_list1.png" /></p>
<p>列表也可以上下滑动：</p>
<p><img alt="" src="../fig03/recycle_view_list2.png" />           </p>
<h2 id="39">3.9 网络相关功能</h2>
<p>网络功能是现代移动应用不可或缺的一部分。掌握网络功能是实现应用与外部世界连接的重要一步。
本章将介绍如何使用Socket编程实现网络通信，以及如何使用okHttp库进行HTTP请求和数据交互。</p>
<h3 id="391-socket">3.9.1 Socket编程</h3>
<p>Socket连接是计算机网络中实现进程间通信的一种方式。它是一种在网络上进行数据传输的抽象概念，使得不同计算机上的进程可以通过网络进行通信。简言之，Socket是一种通信的方式，可以用于在不同计算机之间进行数据传输。它包含了连接所需的相关信息，如IP地址、端口号等。</p>
<p>Socket通信可以分为两种主要方式：TCP（Transmission Control Protocol，传输控制协议）和UDP（User Datagram Protocol，用户数据报协议）。TCP提供可靠的、面向连接的数据传输，而UDP则是无连接的、不可靠的传输方式。TCP连接是一种可靠的、面向连接的通信方式。它通过三次握手建立连接，然后进行数据传输。TCP提供了数据可靠性和顺序性，适用于需要确保数据完整性的场景，如文件传输、网页浏览等。UDP连接是一种无连接的通信方式，不保证数据的可靠性和顺序性。它适用于实时性要求较高、对数据传输实时性要求较高的场景，如音视频传输、实时游戏等。
Socket编程是指使用Socket API进行网络编程的过程，它可以在各种编程语言中进行。通过Socket编程，可以实现客户端和服务器端之间的通信，实现数据的发送和接收。</p>
<p>在Android中Socket连接的基本步骤包括：
-   创建Socket对象：指定服务器的IP地址和端口号。
-   获取输入输出流：用于接收和发送数据。
-   进行数据传输：通过输入输出流读写数据。
-   关闭连接：通信结束后，关闭Socket和相关流。</p>
<p>服务器端将在指定的端口上监听客户端的连接请求，并与客户端进行通信： </p>
<pre><code class="language-java">import java.io.BufferedReader;  
import java.io.InputStreamReader;  
import java.io.OutputStream;  
import java.io.PrintWriter;  
import java.net.ServerSocket;  
import java.net.Socket;  

public class SocketServer {  
    public static void main(String[] args) {  
        int port = 12345; // 服务器端口号  

        try (ServerSocket serverSocket = new ServerSocket(port)) {  
            System.out.println(&quot;服务器启动，等待客户端连接...&quot;);  

            // 等待客户端连接  
            Socket clientSocket = serverSocket.accept();  
            System.out.println(&quot;客户端连接成功：&quot; + clientSocket.getInetAddress().getHostAddress());  

            // 获取输入输出流  
            BufferedReader reader = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));  
            PrintWriter writer = new PrintWriter(clientSocket.getOutputStream(), true);  

            // 读取客户端发送的数据  
            String message = reader.readLine();  
            System.out.println(&quot;收到客户端消息：&quot; + message);  

            // 发送响应给客户端  
            writer.println(&quot;服务器已收到消息：&quot; + message);  

            // 关闭连接  
            reader.close();  
            writer.close();  
            clientSocket.close();  
        } catch (Exception e) {  
            e.printStackTrace();  
        }  
    }  
}  
</code></pre>
<p>客户端将连接到服务器，并发送一条消息，然后接收服务器的响应。</p>
<pre><code class="language-java">import java.io.BufferedReader;  
import java.io.InputStreamReader;  
import java.io.OutputStream;  
import java.io.PrintWriter;  
import java.net.Socket;  

public class SocketClient {  
    public static void main(String[] args) {  
        String serverAddress = &quot;127.0.0.1&quot;; // 服务器IP地址  
        int port = 12345; // 服务器端口号  

        try (Socket socket = new Socket(serverAddress, port)) {  
            System.out.println(&quot;连接到服务器：&quot; + serverAddress);  

            // 获取输入输出流  
            PrintWriter writer = new PrintWriter(socket.getOutputStream(), true);  
            BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));  

            // 发送数据到服务器  
            String message = &quot;Hello, Server!&quot;;  
            writer.println(message);  
            System.out.println(&quot;发送消息到服务器：&quot; + message);  

            // 读取服务器的响应  
            String response = reader.readLine();  
            System.out.println(&quot;收到服务器响应：&quot; + response);  

            // 关闭连接  
            reader.close();  
            writer.close();  
        } catch (Exception e) {  
            e.printStackTrace();  
        }  
    }  
}  
</code></pre>
<h3 id="392-httphttps">3.9.2 HTTP/HTTPS基础</h3>
<p>在Android应用开发中，网络操作是非常常见的需求，如访问Web服务、下载文件和上传数据等。我们需要理解网络基础概念从而开发高效的网络应用。</p>
<p>HTTP（Hypertext Transfer Protocol）是无状态的、应用层的协议，用于传输超文本数据（如HTML）。它是Web应用最常用的协议。HTTPS（Hypertext Transfer Protocol Secure）是HTTP的加密版本，通过SSL/TLS协议进行加密，确保数据传输的安全性。
常见的HTTP请求方法包括：（1）GET：从服务器请求数据。（2）POST：向服务器发送数据。（3）PUT：向服务器更新数据。（4）DELETE：从服务器删除数据。</p>
<p>在网络操作中，数据处理也是关键步骤，包括数据的解析、转换和存储。其中，JSON是一种轻量级的数据交换格式，易于人阅读和编写，同时也易于机器解析和生成。它是Android应用中最常用的数据格式，如：</p>
<pre><code class="language-java">{  
    &quot;name&quot;: &quot;John&quot;,  
    &quot;age&quot;: 30,  
    &quot;city&quot;: &quot;New York&quot;  
}  
</code></pre>
<p>在Android中，可以很方便地对其进行解析，如：</p>
<pre><code class="language-java">JSONObject jsonObject = new JSONObject(responseData);  
// 解析JSON数据  
String name = jsonObject.getString(&quot;name&quot;);  
int age = jsonObject.getInt(&quot;age&quot;);  
String city = jsonObject.getString(&quot;city&quot;);  

System.out.println(&quot;Name: &quot; + name);  
System.out.println(&quot;Age: &quot; + age);  
System.out.println(&quot;City: &quot; + city);  
</code></pre>
<h3 id="393-https">3.9.3 大模型在获取HTTPS内容中的应用</h3>
<p>我们将要写一个简单的应用，实现获取百度网页的内容，并在界面中显示出来。</p>
<p><strong>交互过程1：需求输入</strong></p>
<p><strong>用户：</strong></p>
<p>我想获取百度网页的内容，并在界面中显示出来，应该怎么做？</p>
<hr />
<p><strong>大模型：</strong></p>
<p>要在Android应用中获取百度网页的内容并显示在界面中，可以使用以下步骤：
-   使用HttpURLConnection或OkHttp获取网页的HTML内容。
-   将获取到的HTML内容在WebView中显示出来。</p>
<p>下面是一个完整的示例，包括如何使用OkHttp获取网页内容并在WebView中显示。</p>
<p>步骤1：添加OkHttp依赖</p>
<p>在你的build.gradle文件中添加OkHttp的依赖：</p>
<p>dependencies {
    implementation 'com.squareup.okhttp3:okhttp:4.9.3'
}</p>
<p>步骤2：在布局文件中添加WebView</p>
<p>在你的res/layout/activity_main.xml文件中添加一个WebView：</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  
&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;  
    android:layout_width=&quot;match_parent&quot;  
    android:layout_height=&quot;match_parent&quot;  
    android:orientation=&quot;vertical&quot;&gt;  

    &lt;WebView  
        android:id=&quot;@+id/webview&quot;  
        android:layout_width=&quot;match_parent&quot;  
        android:layout_height=&quot;match_parent&quot; /&gt;  
&lt;/LinearLayout&gt;  
</code></pre>
<p>步骤3：在MainActivity中获取网页内容并显示</p>
<p>在你的MainActivity中编写代码来获取百度网页内容并显示在WebView中：</p>
<pre><code class="language-java">import android.os.AsyncTask;  
import android.os.Bundle;  
import android.webkit.WebView;  
import androidx.appcompat.app.AppCompatActivity;  
import okhttp3.OkHttpClient;  
import okhttp3.Request;  
import okhttp3.Response;  

public class MainActivity extends AppCompatActivity {  

    private WebView webView;  

    @Override  
    protected void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.activity_main);  

        webView = findViewById(R.id.webview);  
        webView.getSettings().setJavaScriptEnabled(true);  

        new FetchWebPageTask().execute(&quot;https://www.baidu.com&quot;);  
    }  

    private class FetchWebPageTask extends AsyncTask&lt;String, Void, String&gt; {  

        @Override  
        protected String doInBackground(String... urls) {  
            String url = urls[0];  
            OkHttpClient client = new OkHttpClient();  
            Request request = new Request.Builder()  
                    .url(url)  
                    .build();  

            try (Response response = client.newCall(request).execute()) {  
                if (response.isSuccessful()) {  
                    return response.body().string();  
                }  
            } catch (Exception e) {  
                e.printStackTrace();  
            }  
            return null;  
        }  

        @Override  
        protected void onPostExecute(String result) {  
            if (result != null) {  
                webView.loadDataWithBaseURL(null, result, &quot;text/html&quot;, &quot;UTF-8&quot;, null);  
            }  
        }  
    }  
} 
</code></pre>
<p>添加OkHttp依赖：在build.gradle文件中添加OkHttp依赖，以便我们可以使用OkHttp库来发送HTTP请求。</p>
<p>添加WebView：在布局文件中添加一个WebView，用于显示网页内容。
获取网页内容并显示：</p>
<ul>
<li>在MainActivity中，使用AsyncTask来执行网络请求。AsyncTask在后台线程中执行网络请求，并在主线程中更新UI。</li>
<li>使用OkHttp发送HTTP请求，获取百度网页的HTML内容。</li>
<li>在onPostExecute方法中，将获取到的HTML内容加载到WebView中显示。</li>
</ul>
<p>这种方法简单有效，可以帮助你在Android应用中获取并显示百度网页的内容。如果需要处理更多复杂的HTML内容，可以考虑使用Jsoup等HTML解析库。</p>
<hr />
<p><strong>操作：</strong></p>
<p>我们将内容复制到对应的文件中，并点击编译运行，发现并没有按照预期显示出百度页面的内容，我们查看LogCat发现错误为：</p>
<pre><code class="language-java">java.lang.SecurityException: Permission denied (missing INTERNET permission?)
</code></pre>
<p>我们继续询问大模型如何解决问题。</p>
<hr />
<p><strong>交互过程2：报错解决</strong></p>
<p><strong>用户：</strong></p>
<p>报错为java.lang.SecurityException: Permission denied (missing INTERNET permission?)，如何解决？</p>
<hr />
<p><strong>大模型：</strong></p>
<p>这个错误表明应用程序缺少访问网络的权限。你需要在Android项目的AndroidManifest.xml文件中声明INTERNET权限。</p>
<p>步骤：在AndroidManifest.xml文件中添加INTERNET权限</p>
<p>打开你的AndroidManifest.xml文件，并在<manifest>标签内添加以下权限声明：
<code>&lt;uses-permission android:name="android.permission.INTERNET" /&gt;</code>,
通过这行代码声明了应用程序需要访问互联网的权限。
这样就可以解决java.lang.SecurityException: Permission denied (missing INTERNET permission?)的错误，并正确加载和显示百度网页的内容了。如果还有其他问题或需要进一步的帮助，请告诉我。</p>
<p><strong>操作：</strong></p>
<p>我们在对应文件中声明网络权限，并再次编译运行程序，此时便可以看到百度的页面。
编译运行程序后看到的界面如下图所示：</p>
<p><img alt="3-11" src="../fig03/3-11.png" /></p>
<!-- 图3-11 网页内容获取 -->

<p>可以看到，确实打开了百度的页面，但是图片没有成功加载。这是由于我们为了演示okhttp3的使用方法而手动渲染了字符串，于是图片的加载被忽略了。实际上直接使用WebView的内置功能即可正常显示页面：</p>
<pre><code class="language-java">webView = findViewById(R.id.webView);  

// 启用JavaScript  
WebSettings webSettings = webView.getSettings();  
webSettings.setJavaScriptEnabled(true);  

// 确保在WebView中打开链接而不是使用外部浏览器  
webView.setWebViewClient(new WebViewClient());  

// 加载百度首页  
webView.loadUrl(&quot;https://www.baidu.com&quot;); 
</code></pre>
<p><img alt="3-12" src="../fig03/3-12.png" /></p>
<!-- 图3-12 图片加载实现 -->
<h2 id="310">3.10 保存和恢复数据</h2>
<p>保存和恢复数据也是移动应用开发过程中很重要的功能，一般的开发过程中主要有如下几个手段来保存数据。</p>
<ol>
<li>SharedPreferences： 轻量级存储，基于XML文件存储键值对数据，适合存储少量的简单数据，如用户偏好设置、登录状态等。通过<code>SharedPreferences</code>对象获取<code>Editor</code>实例，使用<code>putX()</code>方法存储数据，并通过<code>commit()</code>或<code>apply()</code>提交。通过<code>SharedPreferences</code>的<code>getX()</code>方法直接读取数据。</li>
<li>
<p>文件存储：适用于存储大量数据或非结构化数据，如图片、音频、视频等。通过<code>Context</code>的<code>openFileOutput()</code>和<code>openFileInput()</code>方法读写文件。恢复时只需要直接读取存储的文件内容就可以。</p>
</li>
<li>
<p>SQLite数据库：轻量级关系型数据库，适合存储结构化数据，支持复杂查询。通过<code>SQLiteDatabase</code>对象进行数据库操作，包括创建表、插入、查询、更新和删除数据。通过查询操作恢复数据，这里需要大家回顾一下数据库的一些基本操作了。</p>
</li>
<li>
<p>ContentProvider：用于在多个应用之间共享数据，提供标准化的数据访问接口。通过实现<code>ContentProvider</code>类，定义数据结构和访问权限。其他应用通过<code>ContentResolver</code>访问和恢复数据。</p>
</li>
<li>
<p>网络存储：现代的应用开发还有一种比较常用的方式，就是将数据存储在远程服务器，适合需要备份或跨设备同步的场景，很多应用都支持这一模式了。通过网络请求库（如Retrofit、OkHttp）与服务器交互，发送和接收数据。需要使用的时候从服务器下载数据就可以。另外现在还有很多云服务或者云存储的提供商，注册之后就可以很方便的使用数据存储服务了，大家都可以去尝试一下，例如腾讯、七牛云等。</p>
</li>
</ol>
<p>下面我们来看看在前面的Activity跳转案例中，怎么在跳转过程中实现数据的保存和恢复，怎们与大模型交互实现相关功能。</p>
<p><strong>用户：</strong></p>
<p>如何实现数据的保存和恢复？</p>
<hr />
<p>是的，我们可以如此直截了当的问大模型，因为大模型前面已经有了我们应用的上下文信息了，它会基于相关信息进行回答。</p>
<p><strong>大模型：</strong></p>
<p>在Android中，实现数据的保存和恢复通常涉及几个关键步骤。这里我们将通过示例来展示如何在Activity之间实现数据的保存和恢复，即使在屏幕旋转、程序退出到后台再返回时，也能保持数据的完整性。</p>
<p>1.使用onSaveInstanceState()和onRestoreInstanceState()
这两个方法是Activity生命周期中的回调，用于在Activity即将被销毁时保存数据，并在Activity重新创建时恢复数据。</p>
<p>•   保存数据：</p>
<pre><code class="language-Java">@Override  
protected void onSaveInstanceState(Bundle outState) {  
    super.onSaveInstanceState(outState);  
    // 保存需要恢复的数据  
    outState.putString(&quot;my_key&quot;, &quot;my_value&quot;);  
}  
•   恢复数据：
// Java
@Override  
protected void onRestoreInstanceState(Bundle savedInstanceState) {  
    super.onRestoreInstanceState(savedInstanceState);  
    // 在创建视图之后恢复数据  
    String myValue = savedInstanceState.getString(&quot;my_key&quot;);  
    // 使用myValue更新UI或进行其他操作  
}  
</code></pre>
<p>2.使用SharedPreferences</p>
<p>SharedPreferences是一个轻量级的存储类，用于保存应用程序的常用配置。</p>
<p>•   保存数据：</p>
<pre><code class="language-Java">SharedPreferences sharedPreferences = getSharedPreferences(&quot;my_preferences&quot;, MODE_PRIVATE);  
SharedPreferences.Editor editor = sharedPreferences.edit();  
editor.putString(&quot;my_key&quot;, &quot;my_value&quot;);  
editor.apply();  
</code></pre>
<p>•   恢复数据：</p>
<pre><code class="language-Java">SharedPreferences sharedPreferences = getSharedPreferences(&quot;my_preferences&quot;, MODE_PRIVATE);  
String myValue = sharedPreferences.getString(&quot;my_key&quot;, null);  
// 使用myValue更新UI或进行其他操作  
</code></pre>
<p>3.使用onPause()和onResume()</p>
<p>如果你需要在Activity暂停和恢复时保存和恢复数据，可以使用onPause()和onResume()方法。</p>
<p>•   保存数据：</p>
<pre><code class="language-Java">@Override  
protected void onPause() {  
super.onPause();  
// 在这里保存数据到SharedPreferences或其他持久化存储  
}  
</code></pre>
<p>•   恢复数据：</p>
<pre><code class="language-java">@Override  
protected void onResume() {  
    super.onResume();  
    // 在这里从SharedPreferences或其他持久化存储恢复数据  
}  
</code></pre>
<p>注意事项：</p>
<p>• onSaveInstanceState()和onRestoreInstanceState()主要用于在Activity被系统销毁（如屏幕旋转）时保存和恢复临时数据，不应用于持久化存储。</p>
<p>• SharedPreferences适用于存储少量、简单的数据，如用户设置、得分等。</p>
<p>• 对于更复杂的数据结构或需要跨多个组件共享的数据，考虑使用数据库（如Room）或ViewModel与LiveData。</p>
<p>• 在保存和恢复数据时，始终考虑数据的完整性和安全性。</p>
<p>• 避免在onSaveInstanceState()中保存大量数据，因为它可能会导致性能问题或崩溃。</p>
<p>结合这些方法和注意事项，你可以根据应用程序的需求选择最适合的数据保存和恢复策略。</p>
<hr />
<p><strong>操作：</strong>
大模型为我们提供了三种保存和恢复数据的方法，还告诉了我们相应的注意事项，我们可以根据需求进行使用。对于这个简单的APP，我们在创建应用时就确定了数据，而对于复杂的、动态添加数据的APP，我们就必须注意数据的保存与恢复，防止APP进入后台或屏幕旋转等时候数据丢失。当然，对于更加复杂的数据保存，如使用sqlite数据库Room组件等，我们还可以继续在大模型的帮助下看看怎么能够完成，那部分就留给读者自己去探索了。</p>
<p><img alt="3-5" src="../fig03/3-5.png" /></p>
<!-- 图3-5 Activity跳转示例 -->












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    <a href="http://tns.thss.tsinghua.edu.cn/~jiliang/" target="_blank" rel="noopener">
      &copy; 清华大学 - 王继良 - jiliangwang@tsinghua.edu.cn
    </a>
    <br>
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>